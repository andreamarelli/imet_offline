{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/assets/js/mapping_mapbox/utils.js","webpack:///./resources/assets/js/mapping_mapbox/store_modules/visible_components.js","webpack:///./resources/assets/js/mapping_mapbox/demo_card.js","webpack:///./resources/assets/js/mapping_mapbox/demo.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/layers/interactivity.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/utils/utils.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/layers.js","webpack:///./resources/assets/js/mapping.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/utils/choropleth.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/visible_components.js","webpack:///./resources/assets/js/mapping_leaflet/utils.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/library.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/projects.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/api.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/platform.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/map.mixin.js","webpack:///./resources/assets/js/mapping_leaflet/layers.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","tileSize","internalTileSize","mapbox_vector_layer","layer_id","label","type","paint","source_id","version","mapbox_vector_source","window","Laravel","baseUrl","urls","ofac_tiles","mapbox_wms_source","wms_url","layer","tile_size","replace","wms","cache","custom_attributes","url","ofac_mapproxy","ofac_mapserver","options","_","isEmpty","entries","namespaced","state","components","getters","is_component_visible","component","includes","mutations","toggle","this","commit","show","push","hide","splice","indexOf","AnalyticalPlatformCardDemo","Vue","extend","mixins","visible_components","store","Vuex","Store","visible_components_store","data","api_loading","api_errors","api_done","no_cache","Locale","selected_card_button","selected_card_tab","card_has_data","api_cancel_token","api_data","methods","layerIsOnMap","arg","load_demo_api","site","_this","level","theme","axios","method","_token","csrfToken","cancelToken","CancelToken","then","response","console","log","responseCallback","error","isCancel","message","finallyCallback","showCardButton","button","getCachedData","getDataAttribute","attribute_path","paths","split","current","length","deepFind","AnalyticalPlatformMapDemo","map","layers_interactivity","csrf","layers","demo","landscapes_water_transitions","WebMapping","Mapbox","Layers","landscapes_forest_loss_masked","landscapes_forest_mask","landscapes_lc300_1995_2015","landscapes_lc300_2015_2018","landscapes_above_ground_carbon","landscapes_below_ground_carbon","landscapes_soil_organic_carbon","landscapes_total_carbon","overlays","comifac_mask","comifac_eez","countries","landscapes","klc","concessions","protected_areas","map_loading","close_layer_selector_onclick","mounted","initMap","hover_feature","popup","popup_features","click_coords","refreshInteractiveLayers","showPopup","mouseOver","hoverOnRelatedLayer","setMask","setHighlight","condition","filter_attribute","filter_value","addGrayedLayer","setFilter","__grayedLayerId","removeGrayedLayer","addLayer","removeLayer","addMaskedLayer","__maskedLayerId","removeMaskedLayer","on","evt","features","id","forEach","feature_id","_featureHoverOff","_featureHoverOn","__setFeatureHover","hover","setFeatureState","source","sourceLayer","getCanvas","style","cursor","hover_layer_id","related_layer_id","hover_layer_filter_attribute","related_layer_filter_attribute","related_features_ids","querySourceFeatures","filter","properties","removeLayerPopup","lngLat","feature","a","popup_content","feature_index","featurePopupDescription","featurePopupActions","mapboxgl","Popup","setLngLat","setHTML","addTo","document","querySelectorAll","popup_item","popup_features_index","querySelector","addEventListener","event","zoomToFeature","getAPI","remove","getLabel","name_fr","props","red_yellow_green","Array","default","rainbow_10","generateGradientPalette","num_colors","colors","gradstop","stops","inputFormat","colorArray","generateColorPalette","slice","comifac","attribution","spotvgt","modis","srtm","glc2000","congo_basin_vegetation_map","total_carbon","abstract","encodeURI","legend","land_cover","land_cover_change","land_fragmentation","land_degradation","soil_organic_carbon","above_ground_carbon","water_transitions","tree_cover","forest_gain","forest_loss","intact_forest","mapbox_access_token","process","dopa_geoserver","Leaflet","require","opacity","Number","__normalize","numbers","max","Math","isNaN","ratio","v","round","__classify","num_steps","classify","number","class_index","choropleth","palette","keys","values","item","zipObject","toggle_component","$store","show_component","hide_component","mapproxy_wms","layer_name","self","format","transparent","tileLayer","vector_tiles","bounds","latLngBounds","latLng","vectorGrid","protobuf","vectorTileLayerStyles","protected_area","color","weight","fillColor","fillOpacity","fill","mapserver_wms","mapbox_layer","maxZoom","zoomOffset","project_markerCluster","points","marker_cluster","markerClusterGroup","iconCreateFunction","cluster","DivIcon","html","getChildCount","className","iconSize","Point","showCoverageOnHover","zoomToBoundsOnClick","project","lat","lon","popupInfo","title","status","marker","LatLng","icon","AwesomeMarkers","markerColor","prefix","iconColor","bindPopup","getLayersForLeaftletControl","result","api_library_cancel_token","library","count","loading","show_filters","filter_domain","computed","filtered_library","list","orderBy","domains","refreshLibrary","domain","JSON","parse","api_projects_cancel_token","projects","filter_status","filtered_projects","refreshProjects","forest_management","regional","national","biodiversity","convergence_plan","selected_card","__retrieveAPI","nextTick","first_button","getAttribute","cached","stringify","AnalyticalPlatform","api","utils","created","zoomBBoxPadding","watch","reset","refresh","show_layer_selector","zoomToBBox","extents","refreshExclusiveLayers","refreshThematicLayer","toggleLayersSelector","toggleLibrary","toggleProjects","$","collapse","all_layers","thematic_layer","exclusive_active_layer","layers_selected","setLoading","areTilesLoaded","Map","container","__getBounds","minZoom","addControl","NavigationControl","showCompass","e","addSource","addLayerToMap","extent","LngLatBounds","LngLat","bbox","fitBounds","padding","Turf","getLayer","exclusive","removeLayerFromMap","data_driven","vueBus","$emit","sortLayers","removeSource","toggleLayer","moveLayer","mapbox_streets","mapbox_light","mapbox_satellite","borders"],"mappings":"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","file":"/mapping.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = {\n\n    tileSize: 1024,\n    internalTileSize: 1024,\n\n    mapbox_vector_layer: function(layer_id, label = null, type = 'fill', paint = {}, source_id = null, version = null) {\n        return {\n            'id': layer_id,\n            'type': type,\n            'source': source_id || module.exports.mapbox_vector_source(layer_id, version),\n            'source-layer': source_id || layer_id,\n            'paint': paint,\n            label: label\n        }\n    },\n\n    mapbox_vector_source: function(layer_id, version = null){\n        version = version!=null ? '?v='+version : '';\n        return {\n            'type': 'vector',\n            'tiles': [\n                window.Laravel.baseUrl + window.urls.ofac_tiles + layer_id + '/{z}/{x}/{y}.pbf' + version\n            ]\n        }\n    },\n\n    mapbox_wms_source: function(wms_url, layer, tile_size){\n\n        wms_url     = wms_url.replace(/\\??$/, '?');\n        tile_size   = tile_size || module.exports.tileSize;\n\n        let options = wms_url +\n            'service=WMS' +\n            '&version=1.1.1' +\n            '&request=GetMap' +\n            '&format=image/png' +\n            '&transparent=true' +\n            '&styles=' +\n            '&layers=' + layer +\n            '&width=' + tile_size +\n            '&height=' + tile_size +\n            '&bbox={bbox-epsg-3857}' +\n            '&srs=EPSG:3857';\n        return {\n            'type': 'raster',\n            'tiles': [options],\n            'tileSize': tile_size\n        };\n    },\n\n    /**\n     * Get MapServer/MapProxy wms layer\n     * @param layer_id\n     * @param label\n     * @param cache [boolean] (true if should pass by MapProxy)\n     * @param custom_attributes\n     * @returns {*}\n     */\n    wms: function(layer_id, label = null, cache = true, custom_attributes = {}){\n        let url = cache===true\n            ? window.urls.ofac_mapproxy\n            : window.urls.ofac_mapserver;\n\n        url = url.replace(/\\??$/, '?');\n\n        let options = {\n            'id': layer_id,\n            'type': 'raster',\n            'source': module.exports.mapbox_wms_source(url, layer_id, module.exports.internalTileSize),\n            label: label\n        };\n        if(!_.isEmpty(custom_attributes)){\n            for (let [key, value] of Object.entries(custom_attributes)) {\n                options[key] = value;\n            }\n        }\n        return options;\n    },\n\n};\n","const state = {\n    components: []\n};\n\nconst getters = {\n    is_component_visible: (state) => (component) => {\n        return state.components.includes(component);\n    }\n};\n\nconst mutations = {\n\n    toggle(state, component){\n        if(state.components.includes(component)){\n            this.commit('visible_components/hide', component);\n        } else {\n            this.commit('visible_components/show', component);\n        }\n    },\n\n    show(state, component){\n        state.components.push(component);\n    },\n\n    hide(state, component){\n        if(state.components.includes(component)){\n            state.components.splice(state.components.indexOf(component), 1);\n        }\n    }\n};\n\nexport default {\n    namespaced: true,\n    state,\n    getters,\n    mutations\n}\n","import visible_components from \"./mixins/visible_components\";\nimport visible_components_store from \"./store_modules/visible_components\";\n\n\nwindow.AnalyticalPlatformCardDemo = Vue.extend({\n\n    mixins: [\n        visible_components\n    ],\n\n    store: new window.Vuex.Store({\n        modules: {\n            visible_components: visible_components_store\n        }\n    }),\n\n    data: function () {\n        return {\n            // specific for DEMO\n            api_loading: false,\n            api_errors: false,\n            api_done: false,\n            no_cache: false,\n\n            // as for window.AnalyticalPlatform\n            Locale: window.Locale,\n            selected_card_button: null,\n            selected_card_tab: null,\n            card_has_data: false,\n            api_cancel_token: null,\n            api_data: {}\n        }\n    },\n\n    methods:{\n\n        layerIsOnMap(arg){\n            return false;\n        },\n\n        // specific for DEMO\n        load_demo_api(site){\n\n            let _this = this;\n            this.site = site;\n\n            this.api_done = false;\n            this.api_errors = false;\n            this.api_loading = false;\n\n            let url = this.level === 'regional'\n                ? 'api/analysis/' + this.theme + '/' + this.level\n                : 'api/analysis/' + this.theme + '/' + this.level + '/' + site;\n\n            // Cancel previous API request if still running\n            if (this.api_cancel_token !== null) {\n                this.api_cancel_token();\n            }\n\n            this.api_loading = true;\n            this.card_has_data = false;\n\n            window.axios({\n                method: 'post',\n                url: window.Laravel.baseUrl + url,\n                data: {\n                    _token: window.Laravel.csrfToken,\n                    no_cache: _this.no_cache\n                },\n                cancelToken: new window.axios.CancelToken(function executor(c) {\n                    _this.api_cancel_token = c;\n                }),\n            })\n                .then(function (response) {\n                    console.log('Request to API executed');\n                    _this.responseCallback(response.data);\n                    _this.api_done = true;\n                })\n                .catch(function (error) {\n                    if (window.axios.isCancel(error)) {\n                        console.log('Request to API canceled. No more necessary', error.message);\n                    } else {\n                        console.log(error);\n                        _this.api_errors = true;\n                    }\n                })\n                .finally(function () {\n                    _this.finallyCallback();\n                });\n\n        },\n\n        responseCallback(response){\n            console.log(response);\n            this.api_data[this.theme] = this.api_data[this.theme] || [];\n            this.api_data[this.theme][this.level] = this.api_data[this.theme][this.level] || [];\n            if(this.level === 'regional'){\n                this.api_data[this.theme][this.level] = response;\n            } else {\n                this.api_data[this.theme][this.level][this.site] = this.api_data[this.theme][this.level][this.site] || [];\n                this.api_data[this.theme][this.level][this.site] = response;\n            }\n            this.card_has_data = true;\n        },\n        finallyCallback(){\n            this.api_loading = false;\n        },\n\n\n        // as for window.AnalyticalPlatform\n        showCardButton(button) {\n            if (this.selected_card_button !== button) {\n                this.selected_card_button = button;\n            } else {\n                this.selected_card_button = null;\n            }\n        },\n\n        getCachedData() {\n            if(this.level!=='local'){\n                if(this.level==='regional'){\n                    return this.api_data[this.theme][this.level];\n                } else if(this.site!==null\n                    && this.api_data[this.theme][this.level] !== null\n                    && this.api_data[this.theme][this.level].hasOwnProperty(this.site)\n                ){\n                    return this.api_data[this.theme][this.level][this.site];\n                }\n            }\n            return null;\n        },\n\n        getDataAttribute(attribute_path){\n            let data = this.getCachedData();\n            if(data!==null){\n                // return data[attribute_path];\n                let deepFind = function(data, attribute_path){\n                    let paths = attribute_path.split('.');\n                    let current = data;\n                    for (let i=0; i<paths.length; ++i) {\n                        if (!current.hasOwnProperty(paths[i])) {\n                            return null;\n                        } else {\n                            current = current[paths[i]];\n                        }\n                    }\n                    return current;\n                };\n                return deepFind(data, attribute_path)\n            }\n            return null;\n        },\n\n    }\n\n});\n","\nimport map from './mixins/map.mixin';\nimport layers_interactivity from \"./mixins/layers/interactivity.mixin\";\nimport visible_components from \"./mixins/visible_components\";\nimport visible_components_store from \"./store_modules/visible_components\";\n\n\nwindow.AnalyticalPlatformMapDemo = Vue.extend({\n\n    mixins: [\n        map,\n        layers_interactivity,\n        visible_components\n    ],\n\n    store: new window.Vuex.Store({\n        modules: {\n            visible_components: visible_components_store\n        }\n    }),\n\n    data: function () {\n        return {\n\n            Locale: window.Locale,\n            csrf: window.Laravel.csrfToken,\n\n            layers: {\n                demo: {\n                    landscapes_water_transitions: window.WebMapping.Mapbox.Layers.landscapes_water_transitions,\n                    landscapes_forest_loss_masked: window.WebMapping.Mapbox.Layers.landscapes_forest_loss_masked,\n                    landscapes_forest_mask: window.WebMapping.Mapbox.Layers.landscapes_forest_mask,\n                    //lc300_class4_1995: window.WebMapping.Mapbox.Layers.lc300_class4_1995,\n                    //lc300_class4_2015: window.WebMapping.Mapbox.Layers.lc300_class4_2015,\n                    //lc300_class4_2018: window.WebMapping.Mapbox.Layers.lc300_class4_2018,\n                    landscapes_lc300_1995_2015: window.WebMapping.Mapbox.Layers.landscapes_lc300_1995_2015,\n                    landscapes_lc300_2015_2018: window.WebMapping.Mapbox.Layers.landscapes_lc300_2015_2018,\n                    landscapes_above_ground_carbon: window.WebMapping.Mapbox.Layers.landscapes_above_ground_carbon,\n                    landscapes_below_ground_carbon: window.WebMapping.Mapbox.Layers.landscapes_below_ground_carbon,\n                    landscapes_soil_organic_carbon: window.WebMapping.Mapbox.Layers.landscapes_soil_organic_carbon,\n                    landscapes_total_carbon: window.WebMapping.Mapbox.Layers.landscapes_total_carbon,\n                },\n                overlays: {\n                    comifac_mask: window.WebMapping.Mapbox.Layers.comifac_mask,\n                    comifac_eez: window.WebMapping.Mapbox.Layers.comifac_eez,\n                    countries: window.WebMapping.Mapbox.Layers.countries,\n                    landscapes: window.WebMapping.Mapbox.Layers.landscapes,\n                    klc: window.WebMapping.Mapbox.Layers.klc,\n                    concessions: window.WebMapping.Mapbox.Layers.concessions,\n                    protected_areas: window.WebMapping.Mapbox.Layers.protected_areas\n                }\n            },\n\n            map_loading: false,\n\n            close_layer_selector_onclick: false\n        }\n    },\n\n    mounted(){\n        this.initMap();\n        this.map_loading = false;\n    },\n\n    methods: {\n\n    }\n\n});\n","export default {\n\n    data() {\n        return {\n            hover_feature: [],\n            popup: null,\n            popup_features: [],\n            click_coords: null\n        }\n    },\n\n    methods: {\n\n        // #######################################################\n        // ######  Manage dynamic layers' interactivity  #########\n        // #######################################################\n\n        refreshInteractiveLayers(){\n            // countries\n            this.showPopup('countries');\n            this.mouseOver('countries');\n            this.hoverOnRelatedLayer('countries', 'comifac_eez', 'iso3', 'ISO_Ter1');\n            this.setMask('countries',\n                (this.level==='national' && this.site!==null),\n                'iso3',\n                this.site\n            );\n            // eez\n            this.mouseOver('comifac_eez');\n            this.hoverOnRelatedLayer('comifac_eez', 'countries', 'ISO_Ter1', 'iso3');\n            this.setMask('comifac_eez',\n                (this.level==='national' && this.site!==null),\n                'ISO_Ter1',\n                this.site\n            );\n            // landscapes\n            this.showPopup('landscapes');\n            this.mouseOver('landscapes');\n            // landscapes klc\n            this.showPopup('klc');\n            this.mouseOver('klc');\n            // protected_areas\n            this.showPopup('protected_areas');\n            this.mouseOver('protected_areas');\n            this.setHighlight('protected_areas',\n                (this.level==='national' && this.site!==null),\n                'country',\n                this.site\n            );\n            // concessions\n            this.showPopup('concessions');\n            this.mouseOver('concessions');\n            this.setHighlight('concessions',\n                (this.level==='national' && this.site!==null),\n                'country',\n                this.site\n            );\n        },\n\n        // ########  Highlight filtered features  ######\n\n        setHighlight(layer_id, condition, filter_attribute, filter_value){\n            if(this.layerIsOnMap(layer_id)) {\n                if (condition) {\n                    this.addGrayedLayer(layer_id);\n                    this.map.setFilter(layer_id, ['==', filter_attribute, filter_value]);\n                    this.map.setFilter(this.__grayedLayerId(layer_id), ['!=', filter_attribute, filter_value]);\n                } else {\n                    this.removeGrayedLayer(layer_id);\n                    this.map.setFilter(layer_id, true);\n                }\n            } else {\n                this.removeGrayedLayer(layer_id);\n            }\n        },\n\n        __grayedLayerId(layer_id){\n            return layer_id + '_grayed';\n        },\n\n        addGrayedLayer(layer_id){\n            if(!this.layerIsOnMap(this.__grayedLayerId(layer_id))){\n                this.map.addLayer({\n                    'id': this.__grayedLayerId(layer_id),\n                    'type': 'fill',\n                    'source': layer_id,\n                    'source-layer': layer_id,\n                    'paint': {\n                        \"fill-color\": 'rgba(180, 180, 180, 0.5)',\n                    },\n                });\n            }\n        },\n\n        removeGrayedLayer(layer_id){\n            if(this.layerIsOnMap(this.__grayedLayerId(layer_id))){\n                this.map.removeLayer(this.__grayedLayerId(layer_id));\n            }\n        },\n\n\n        // ########  Mask unwanted features  ######\n\n        setMask(layer_id, condition, filter_attribute, filter_value){\n            if(this.layerIsOnMap(layer_id)) {\n                if (filter_value !== null && condition) {\n                    this.addMaskedLayer(layer_id);\n                    this.map.setFilter(this.__maskedLayerId(layer_id), ['!=', filter_attribute, filter_value]);\n                } else {\n                    this.removeMaskedLayer(layer_id);\n                }\n            } else {\n                this.removeMaskedLayer(layer_id);\n            }\n        },\n\n        __maskedLayerId(layer_id){\n            return layer_id + '_masked';\n        },\n\n        addMaskedLayer(layer_id){\n            if(!this.layerIsOnMap(this.__maskedLayerId(layer_id))){\n                this.map.addLayer({\n                    'id': this.__maskedLayerId(layer_id),\n                    'type': 'fill',\n                    'source': layer_id,\n                    'source-layer': layer_id,\n                    'paint': {\n                        \"fill-color\": 'rgba(0, 0, 0, 0.5)',\n                        \"fill-outline-color\": 'rgba(0, 0, 0, 0.5)',\n                    },\n                });\n            }\n        },\n\n        removeMaskedLayer(layer_id){\n            if(this.layerIsOnMap(this.__maskedLayerId(layer_id))){\n                this.map.removeLayer(this.__maskedLayerId(layer_id));\n            }\n        },\n\n        // ########  Highlight on mouse hover  ######\n\n        mouseOver(layer_id){\n            let _this = this;\n            if(_this.layerIsOnMap(layer_id)) {\n                _this.hover_feature[layer_id] = _this.hover_feature[layer_id] || [];\n                this.map.on('mousemove', layer_id, function (evt) {\n                    if (!_this.hover_feature[layer_id].includes(evt.features[0].id)) {\n                        _this.hover_feature[layer_id].forEach(function(feature_id){\n                            _this._featureHoverOff(layer_id, feature_id);\n                        });\n                        _this._featureHoverOn( layer_id, evt.features[0].id);\n                    }\n                });\n                this.map.on('mouseleave', layer_id, function () {\n                    _this.hover_feature[layer_id].forEach(function(feature_id){\n                        _this._featureHoverOff(layer_id, feature_id);\n                    });\n                });\n            }\n        },\n\n        __setFeatureHover(feature_id, layer_id, hover){\n            this.map.setFeatureState({\n                source: layer_id,\n                sourceLayer: layer_id,\n                id: feature_id\n            }, {\n                hover: hover\n            });\n        },\n\n        _featureHoverOn(layer_id, feature_id){\n            this.hover_feature[layer_id].push(feature_id);\n            this.__setFeatureHover(feature_id, layer_id, true);\n            this.map.getCanvas().style.cursor = 'pointer';\n        },\n        _featureHoverOff(layer_id, feature_id){\n            if (this.hover_feature[layer_id].includes(feature_id)) {\n                this.__setFeatureHover(feature_id, layer_id, false);\n                this.map.getCanvas().style.cursor = '';\n                this.hover_feature[layer_id].splice(this.hover_feature[layer_id].indexOf(feature_id), 1);\n            }\n        },\n\n        hoverOnRelatedLayer(hover_layer_id, related_layer_id, hover_layer_filter_attribute, related_layer_filter_attribute){\n            let _this = this;\n            if(_this.layerIsOnMap(hover_layer_id) && _this.layerIsOnMap(related_layer_id)) {\n                _this.hover_feature[hover_layer_id] = _this.hover_feature[hover_layer_id] || [];\n                _this.hover_feature[related_layer_id] = _this.hover_feature[related_layer_id] || [];\n                this.map.on('mousemove', hover_layer_id, function (evt) {\n                    let related_features_ids = _this.map.querySourceFeatures(related_layer_id, {\n                        sourceLayer: related_layer_id,\n                        filter: ['==', related_layer_filter_attribute, evt.features[0].properties[hover_layer_filter_attribute]]\n                    }).map(({ id }) => id);\n                    _this.hover_feature[related_layer_id].forEach(function(feature_id){\n                        if(!related_features_ids.includes(feature_id)){\n                            _this._featureHoverOff(related_layer_id, feature_id);\n                        }\n                    });\n                    related_features_ids.forEach(function (feature_id) {\n                        if (!_this.hover_feature[related_layer_id].includes(feature_id)) {\n                            _this._featureHoverOn(related_layer_id, feature_id);\n                        }\n                    });\n                });\n                this.map.on('mouseleave', hover_layer_id, function () {\n                    _this.hover_feature[related_layer_id].forEach(function(feature_id){\n                        _this._featureHoverOff(related_layer_id, feature_id);\n                    });\n                });\n            }\n        },\n\n        // ########  Popup  ######\n\n        showPopup(layer_id){\n            let _this = this;\n            if(_this.layerIsOnMap(layer_id)) {\n                _this.map.on('click', layer_id, function (evt) {\n                    _this.removeLayerPopup(evt);\n                    // Collect all clicked features\n                    _this.click_coords = evt.lngLat;\n                    evt.features.forEach(function (feature) {\n                        let ids = _this.popup_features.map(a => a.id);\n                        if (!ids.includes(feature.id)) {\n                            _this.popup_features.push(feature);\n                        }\n                    });\n\n                    // Build popUp content\n                    let popup_content = '';\n                    _this.popup_features.forEach(function (feature, feature_index) {\n                        popup_content +=\n                            '<div class=\"popup-item\" id=\"popup-item_' + feature_index + '\">' +\n                            _this.featurePopupDescription(feature) +\n                            _this.featurePopupActions(feature) +\n                            '</div>';\n                    });\n\n                    _this.popup = new window.mapboxgl.Popup()\n                        .setLngLat(evt.lngLat)\n                        .setHTML(popup_content)\n                        .addTo(_this.map);\n\n                    // Add manually the EventListener. v-on directive on button added by mapboxgl.Popup (after VUeJS render) does not work.\n                    document.querySelectorAll('.mapboxgl-popup .popup-item')\n                        .forEach(function (popup_item) {\n                            let popup_features_index = popup_item.id.replace('popup-item_', '');\n                            let button = popup_item.querySelector('button.getAPI');\n                            if (button !== null) {\n                                button.addEventListener('click', (event) => {\n                                    let feature = _this.popup_features[popup_features_index];\n                                    _this.zoomToFeature(feature);\n                                    _this.getAPI(feature.id);\n                                });\n                            }\n                        });\n                });\n            }\n        },\n\n        removeLayerPopup(evt = null){\n            if(this.popup!==null){\n                this.popup.remove();\n            }\n            this.popup = null;\n            if(evt===null || (this.click_coords!=null && this.click_coords!==evt.lngLat)){\n                this.popup_features = [];\n            }\n        },\n\n        featurePopupDescription(feature){\n            // console.log(feature.properties);\n            if(feature.layer.id === 'countries'){\n                return '<i>' + this.Locale.getLabel('mapping.platform.sites.countries', 1) + '</i><br />' +\n                    '<b class=\"green\">' + feature.properties.name_fr + '</b>';\n            }\n            else{\n                return '<i>' + this.Locale.getLabel('mapping.platform.sites.'+feature.layer.id, 1) + '</i><br />' +\n                    '<b class=\"green\">' + feature.properties.name + '</b>';\n            }\n        },\n\n        featurePopupActions(feature){\n            if(feature.layer.id === this.level){\n                return '<div class=\"popup-footer\">' +\n                    '<button class=\"btn btn-sm act-btn-basic getAPI\">' + this.Locale.getLabel('mapping.platform.analysis') + '</button>' +\n                    '</div>';\n            }\n            return '';\n        },\n\n    }\n}\n","export default {\n\n    props:{\n        red_yellow_green: {\n            type: Array,\n            default: () => [\n                '#ce2e29',  // $darkRed\n                '#f9c74f',\n                '#007233'   // $darkGreen\n            ]\n        },\n        rainbow_10:{\n            type: Array,\n            default: () => [\n                '#404887',\n                '#3374ff',\n                '#43aa8b',\n                '#90be6d',\n                '#f9c74f',\n                '#f3722c',\n                '#f94144',\n                '#d35e9d',\n                '#ad7af6',\n                '#e7c1cb',\n                '#c9bcb5',\n                '#5f6269',\n            ]\n        }\n    },\n\n    methods: {\n\n        /**\n         * Generate a gradient color palette (using https://github.com/Siddharth11/gradstop)\n         *\n         * @param num_colors\n         * @param colors\n         */\n        generateGradientPalette(num_colors, colors) {\n            colors = colors || this.red_yellow_green;\n            return gradstop({\n                stops: num_colors,\n                inputFormat: 'hex',\n                colorArray: colors\n            });\n        },\n\n        /**\n         * Return a palette from the given array of colors\n         *\n         * @param num_colors\n         * @param colors\n         * @returns {T[]}\n         */\n        generateColorPalette(num_colors, colors) {\n            colors = colors || this.rainbow_10;\n            return colors.slice(0, num_colors);\n        }\n\n\n    }\n}","module.exports = {\n\n    // ##########  Rasters  ##########\n\n    comifac:  window.WebMapping.Mapbox.wms('comifac', Locale.getLabel('mapping.layers.comifac'),true, {\n        attribution: '<div style=\"width: 800px;\">' +\n            '<b>Image source de base :</b> Verhegghen, A., Mayaux, P., de Wasseige, C., and Defourny, P.: ' +\n            'Mapping Congo Basin vegetation types from 300 m and 1 km multi-sensor time series for carbon stocks' +\n            ' and forest areas estimation, Biogeosciences, 9, 5061-5079, doi:10.5194/bg-9-5061-2012, 2012. ' +\n            '<a target=\"_blank\" href=\"https://www.biogeosciences.net/9/5061/2012/bg-9-5061-2012.html\">biogeosciences.net</a>'+\n            '<br/><b>Donnes sources ajoutes :</b> SRTM de la Nasa, OSM et OFAC'+\n            '<br/><b>Traite :</b> Mai 2015, <a target=\"_blank\" href=\"/docs/atlas/mapsteps.pdf\">Etapes de ralisation</a></div>',\n    }),\n    spotvgt:  window.WebMapping.Mapbox.wms('spotvgt', Locale.getLabel('mapping.layers.spotvgt'), true),\n    modis:  window.WebMapping.Mapbox.wms('modis', Locale.getLabel('mapping.layers.modis'), true),\n    srtm:  window.WebMapping.Mapbox.wms('srtm', Locale.getLabel('mapping.layers.srtm'), true),\n    glc2000:  window.WebMapping.Mapbox.wms('glc2000', Locale.getLabel('mapping.layers.glc2000'), true),\n    congo_basin_vegetation_map:  window.WebMapping.Mapbox.wms('congo_basin_vegetation_map', Locale.getLabel('mapping.layers.congo_basin_vegetation_map'), true),\n    total_carbon:  window.WebMapping.Mapbox.wms('total_carbon', Locale.getLabel('mapping.layers.total_carbon'), true),\n\n    landscapes_forest_loss_masked:  window.WebMapping.Mapbox.wms('landscapes_forest_loss_masked',\n        Locale.getLabel('mapping.layers.landscapes_forest_loss_masked'), false, {\n            abstract: 'From the <a target=\"_blank\" href=\"https://earthenginepartners.appspot.com/science-2013-global-forest/download_v1.7.html\">' +\n                'Lossyear Hansen map</a> masked by the forest presence in 2000'\n        }),\n    landscapes_forest_mask:  window.WebMapping.Mapbox.wms('landscapes_forest_mask',\n        Locale.getLabel('mapping.layers.landscapes_forest_mask'), false, {\n            abstract: encodeURI('Computed with the Forest 2000 Hansen map, Forest cover more than 30% was retain as forest threshold'),\n            legend: [\n                {'color': '#5BCD59', 'label': 'Forest'}\n            ]\n        }),\n    landscapes_lc300_1995_2015:  window.WebMapping.Mapbox.wms('landscapes_lc300_1995_2015',\n        Locale.getLabel('mapping.layers.landscapes_lc300_1995_2015'), false, {\n            abstract: 'Source: ESA-CCI, <a target=\"_blank\" href=\"http://www.esa-landcover-cci.org/\">http://www.esa-landcover-cci.org/</a>',\n            legend:[\n                {'color': '#0e7a04', 'label': 'Cultivated to Natural areas'},\n                {'color': '#20b4a5', 'label': 'Cultivated areas to Water'},\n                {'color': '#eb6d82', 'label': 'Mosaic Nat/Cult to Cultivated areas'},\n                {'color': '#3db611', 'label': 'Mosaic Nat/Cult to Natural areas'},\n                {'color': '#1aaeed', 'label': 'Mosaic Nat/Cult areas to Water'},\n                {'color': '#e6091b', 'label': 'Natural to Cultivated areas'},\n                {'color': '#ef7707', 'label': 'Natural to Mosaic Nat/Cult areas'},\n                {'color': '#3c75c9', 'label': 'Natural areas to Water'},\n                {'color': '#fbb451', 'label': 'Water/Snow to Cultivated areas'},\n                {'color': '#dfef61', 'label': 'Water/Snow to Mosaic Nat/Cult areas'},\n                {'color': '#00cd7e', 'label': 'Water/Snow to Natural areas'},\n                {'color': '#af8354', 'label': 'Cultivated to Mosaic Nat/Cult areas'},\n            ]\n        }),\n    landscapes_lc300_2015_2018:  window.WebMapping.Mapbox.wms('landscapes_lc300_2015_2018',\n        Locale.getLabel('mapping.layers.landscapes_lc300_2015_2018'), false, {\n            abstract: 'Source: ESA-CCI, <a target=\"_blank\" href=\"http://www.esa-landcover-cci.org/\">http://www.esa-landcover-cci.org/</a>',\n            legend:[\n                {'color': '#0e7a04', 'label': 'Cultivated to Natural areas'},\n                {'color': '#20b4a5', 'label': 'Cultivated areas to Water'},\n                {'color': '#eb6d82', 'label': 'Mosaic Nat/Cult to Cultivated areas'},\n                {'color': '#3db611', 'label': 'Mosaic Nat/Cult to Natural areas'},\n                {'color': '#1aaeed', 'label': 'Mosaic Nat/Cult areas to Water'},\n                {'color': '#e6091b', 'label': 'Natural to Cultivated areas'},\n                {'color': '#ef7707', 'label': 'Natural to Mosaic Nat/Cult areas'},\n                {'color': '#3c75c9', 'label': 'Natural areas to Water'},\n                {'color': '#fbb451', 'label': 'Water/Snow to Cultivated areas'},\n                {'color': '#dfef61', 'label': 'Water/Snow to Mosaic Nat/Cult areas'},\n                {'color': '#00cd7e', 'label': 'Water/Snow to Natural areas'},\n                {'color': '#af8354', 'label': 'Cultivated to Mosaic Nat/Cult areas'},\n            ]\n        }),\n    landscapes_above_ground_carbon:  window.WebMapping.Mapbox.wms('landscapes_above_ground_carbon',\n        Locale.getLabel('mapping.layers.landscapes_above_ground_carbon'), false,{\n        abstract: 'Above Ground Carbon * 0.5 (conversion factor (Biomass-> Carbon)). Water have been converted in \"NoData\". <br />' +\n            'Santoro, M., Cartus, O., Mermoz, S., Bouvet, A., Le Toan, T., Carvalhais, N., Rozendaal, D., ' +\n            'Herold, M., Avitabile, V., Quegan, S., Carreiras, J., Rauste, Y., Balzter, H., Schmullius, C., Seifert, F.M., 2018, ' +\n            '<b>GlobBiomass global above-ground biomass and growing stock volume datasets</b>, available on-line ' +\n            '<a target=\"_blank\" href=\"https://globbiomass.org/products/global-mapping\">here</a>'\n    }),\n    landscapes_below_ground_carbon:  window.WebMapping.Mapbox.wms('landscapes_below_ground_carbon',\n        Locale.getLabel('mapping.layers.landscapes_below_ground_carbon'), false, {\n            abstract: 'Above Ground Carbon map * R (Root factor (Stem Carbon -> Root Carbon)). The R factor defined ' +\n                'by the <a target=\"_blank\" href=\"https://www.ipcc-nggip.iges.or.jp/public/2019rf/pdf/4_Volume4/19R_V4_Ch04_Forest%20Land.pdf\">' +\n                '2019 Refinement to the 2006 IPCC Guidelines for National Greenhouse Gas Inventories</a>.'\n        }),\n    landscapes_soil_organic_carbon:  window.WebMapping.Mapbox.wms('landscapes_soil_organic_carbon',\n        Locale.getLabel('mapping.layers.landscapes_soil_organic_carbon'), false,{\n            abstract: '<b>Global Soil Organic Carbon Map (GSOCmap)</b> from FAO available <a target=\"_blank\" ' +\n                'href=\"http://54.229.242.119/GSOCmap/\">here</a>'\n        }),\n    landscapes_total_carbon:  window.WebMapping.Mapbox.wms('landscapes_total_carbon',\n        Locale.getLabel('mapping.layers.landscapes_total_carbon'), false, {\n            abstract: 'Addition of the <b>Above Ground Carbon</b>, <b>Below Ground Carbon</b> and <b>Soil Organic Carbon maps</b>'\n        }),\n    landscapes_water_transitions: window.WebMapping.Mapbox.wms('landscapes_water_transitions',\n        Locale.getLabel('mapping.layers.landscapes_water_transitions'), false, {\n            abstract: encodeURI('Jean-Francois Pekel, Andrew Cottam, Noel Gorelick, Alan S. Belward, <b>High-resolution ' +\n                'mapping of global surface water and its long-term changes.</b> Nature 540, 418-422 (2016). (doi:10.1038/nature20584)' +\n                '<br />Accessed through <a href=\"https://global-surface-water.appspot.com/\" target=\"_blank\">Global Surface Water Explorer</a>' +\n                '<br />Source: EC JRC/Google'),\n            legend: [\n                {'color': '#0000dd', 'label': 'Permanent'},\n                {'color': '#22b14c', 'label': 'New Permanent'},\n                {'color': '#93073e', 'label': 'Lost Permanent'},\n                {'color': '#99d9ea', 'label': 'Seasonal'},\n                {'color': '#b5e61d', 'label': 'New Seasonal'},\n                {'color': '#ff8b37', 'label': 'Lost Seasonal'},\n                {'color': '#ffdd66', 'label': 'Seasonal to Permanent'},\n                {'color': '#ebb4bb', 'label': 'Permanent to Seasonal'},\n                {'color': '#7f7f7f', 'label': 'Ephemeral Permanent'},\n                {'color': '#acacac', 'label': 'Ephemeral Seasonal'}\n            ]\n        }),\n\n    // ##########  DOPA Resources  ##########\n\n    land_cover:{\n        id: 'land_cover',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'land_cover_copernicus_2018'),\n        label: 'Couverture du Sol',\n        abstract: '&copy; Services DOPA'\n    },\n    land_cover_change:{\n        id: 'land_cover_change',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'LCC_1995_2015'),\n        label: 'Changement d\\'occupation du sol',\n        abstract: '&copy; Services DOPA'\n    },\n    land_fragmentation: {\n        id: 'land_fragmentation',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'land_fragmentation'),\n        label: 'Fragmentation des terres',\n        abstract: '&copy; Services DOPA'\n    },\n    land_degradation: {\n        id: 'land_degradation',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'LPD'),\n        label: 'Dgradation des terres',\n        abstract: '&copy; Services DOPA'\n    },\n    soil_organic_carbon: {\n        id: 'soil_organic_carbon',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'soil_organic_carbon'),\n        label: 'Carbone organique du sol',\n        abstract: '&copy; Services DOPA'\n    },\n    above_ground_carbon: {\n        id: 'above_ground_carbon',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'above_ground_carbon'),\n        label: 'Carbon au-dessous du sol',\n        abstract: '&copy; Services DOPA'\n    },\n\n    // ##########  Other External Resources  ##########\n\n    water_transitions: {\n        id: \"water_transitions\",\n        type: \"raster\",\n        source: {\n            \"type\": \"raster\",\n            \"tiles\": [\"https://storage.googleapis.com/global-surface-water/tiles2019/transitions/{z}/{x}/{y}.png\"],\n            \"attribution\": 'Source: EC JRC/Google'\n        },\n        label:  Locale.getLabel('mapping.layers.water_transitions'),\n        abstract: encodeURI('Jean-Francois Pekel, Andrew Cottam, Noel Gorelick, Alan S. Belward, <b>High-resolution ' +\n            'mapping of global surface water and its long-term changes.</b> Nature 540, 418-422 (2016). (doi:10.1038/nature20584)' +\n            '<br />Accessed through <a href=\"https://global-surface-water.appspot.com/\" target=\"_blank\">Global Surface Water Explorer</a>' +\n            '<br />Source: EC JRC/Google')\n    },\n    tree_cover: {\n        id: 'tree_cover',\n        type: 'raster',\n        source:{\n            \"type\": \"raster\",\n            \"tiles\": [\"https://storage.googleapis.com/earthenginepartners-hansen/tiles/gfc_v1.4/tree_alpha/{z}/{x}/{y}.png\"],\n            //\"tiles\": [\"https://storage.googleapis.com/wri-public/treecover/2010/{z}/{x}/{y}.png\"],\n            \"attribution\": \"Hansen/UMD/Google/USGS/NASA\"\n        },\n        label: 'Tree Cover 2000-2010',\n        abstract: encodeURI('Hansen, M. C., P. V. Potapov, R. Moore, M. Hancher, S. A. Turubanova, A. Tyukavina, D. Thau, S. V. Stehman, S. J. Goetz, ' +\n            'T. R. Loveland, A. Kommareddy, A. Egorov, L. Chini, C. O. Justice, and J. R. G. Townshend. 2013. <b>High-Resolution Global Maps of 21st-Century Forest Cover Change.</b> ' +\n            'Science 342 (15 November): 85053. <br />Data available on-line from: <a href=\"https://glad.umd.edu/dataset/global-2010-tree-cover-30-m\" target=\"_blank\">https://glad.umd.edu/dataset/global-2010-tree-cover-30-m</a>. ' +\n            '<br />Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    },\n    forest_gain: {\n        id: 'forest_gain',\n        type: 'raster',\n        source:{\n            \"type\": \"raster\",\n            \"tiles\": [\"https://storage.googleapis.com/earthenginepartners-hansen/tiles/gfc_v1.4/gain_alpha/{z}/{x}/{y}.png\"],\n            \"attribution\": \"Hansen/UMD/Google/USGS/NASA\"\n        },\n        label: 'Forest cover gain 20002012',\n        abstract: encodeURI('Hansen, M. C., P. V. Potapov, R. Moore, M. Hancher, S. A. Turubanova, A. Tyukavina, D. Thau, S. V. Stehman, S. J. Goetz, ' +\n            'T. R. Loveland, A. Kommareddy, A. Egorov, L. Chini, C. O. Justice, and J. R. G. Townshend. 2013. <b>High-Resolution Global Maps of 21st-Century Forest Cover Change.</b> ' +\n            'Science 342 (15 November): 85053. <br />Data available on-line from: <a href=\"https://glad.umd.edu/dataset/global-2010-tree-cover-30-m\" target=\"_blank\">https://glad.umd.edu/dataset/global-2010-tree-cover-30-m</a>. ' +\n            '<br />Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    },\n    forest_loss: {\n        id: 'forest_loss',\n        type: 'raster',\n        source:{\n            \"type\": \"raster\",\n            \"tiles\": [\"https://storage.googleapis.com/earthenginepartners-hansen/tiles/gfc_v1.7/loss_alpha/{z}/{x}/{y}.png\"],\n            \"attribution\": \"Hansen/UMD/Google/USGS/NASA\"\n        },\n        label: 'Forest cover loss 20002018',\n        abstract: encodeURI('Hansen, M. C., P. V. Potapov, R. Moore, M. Hancher, S. A. Turubanova, A. Tyukavina, D. Thau, S. V. Stehman, S. J. Goetz, ' +\n            'T. R. Loveland, A. Kommareddy, A. Egorov, L. Chini, C. O. Justice, and J. R. G. Townshend. 2013. <b>High-Resolution Global Maps of 21st-Century Forest Cover Change.</b> ' +\n            'Science 342 (15 November): 85053. <br />Data available on-line from: <a href=\"https://glad.umd.edu/dataset/global-2010-tree-cover-30-m\" target=\"_blank\">https://glad.umd.edu/dataset/global-2010-tree-cover-30-m</a>. ' +\n            '<br />Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    },\n    intact_forest: {\n        id: \"intact_forest\",\n        type: \"raster\",\n        source: {\n            \"type\": \"raster\",\n            \"tiles\": [\"https://storage.googleapis.com/earthenginepartners-hansen/tiles/intact_forest_2016/{z}/{x}/{y}.png\"],\n            \"attribution\": 'Map tiles by <a target=\"_top\" rel=\"noopener\" href=\"https://stamen.com\">Stamen Design</a>, under <a target=\"_top\" rel=\"noopener\" href=\"https://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a target=\"_top\" rel=\"noopener\" href=\"https://openstreetmap.org\">OpenStreetMap</a>, under <a target=\"_top\" rel=\"noopener\" href=\"https://creativecommons.org/licenses/by-sa/3.0\">CC BY SA</a>'\n        },\n        label: 'Intact Forest Landscapes (IFL 2000-2016)',\n        abstract: encodeURI('Greenpeace, University of Maryland, World Resources Institute and Transparent World. Intact Forest Landscapes. 2000/2013/2016 ' +\n            'Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    },\n\n    // ##########  Overlays  ##########\n    comifac_mask:  window.WebMapping.Mapbox.wms('comifac_mask', null, true),\n\n    comifac_eez: window.WebMapping.Mapbox.mapbox_vector_layer('comifac_eez', null, 'fill', {\n        'fill-color':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 'rgba(255, 255, 255, 0.3)',\n                'rgba(255, 255, 255, 0)',\n            ],\n        'fill-outline-color': 'rgba(60, 150, 255, 0.8)'\n    }),\n\n    countries: window.WebMapping.Mapbox.mapbox_vector_layer('countries', null, 'fill', {\n        'fill-color':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 'rgba(255, 255, 255, 0.3)',\n                'rgba(255, 255, 255, 0)',\n            ],\n        'fill-outline-color': 'rgba(0, 50, 0, 0.8)'\n    },\n    'countries'),\n\n    landscapes: window.WebMapping.Mapbox.mapbox_vector_layer('landscapes', Locale.getLabel('mapping.platform.sites.landscapes', 2), 'fill', {\n        'fill-color': 'rgb(255, 255, 0)',\n        'fill-opacity':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 0.8,\n                0.5\n            ]\n    }),\n    klc: window.WebMapping.Mapbox.mapbox_vector_layer('klc', Locale.getLabel('mapping.platform.sites.klc', 2), 'fill', {\n        'fill-color': 'rgb(255, 155, 0)',\n        'fill-opacity':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 0.8,\n                0.5\n            ]\n    }, null, '2021-04'),\n    concessions: window.WebMapping.Mapbox.mapbox_vector_layer('concessions', Locale.getLabel('mapping.platform.sites.concessions', 2), 'fill', {\n        'fill-color': 'rgb(163, 113, 66)',\n        'fill-opacity':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 0.8,\n                0.5\n            ]\n    }),\n    protected_areas: window.WebMapping.Mapbox.mapbox_vector_layer('protected_areas', Locale.getLabel('mapping.platform.sites.protected_areas', 2), 'fill', {\n        'fill-color': 'rgb(0, 115, 40)',\n        'fill-opacity':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 0.8,\n                0.5\n            ]\n    },\n    'protected_areas', '2021-05-05')\n\n\n};\n","// Environment variables\nwindow.mapbox_access_token = process.env.MIX_MAPBOX_ACCESS_TOKEN;\n\n// Urls\nwindow.urls = window.urls || {};\nwindow.urls.ofac_mapserver = 'https://ies-ows.jrc.ec.europa.eu/ofac/' + 'ofacgeo.php?';\nwindow.urls.ofac_mapproxy = 'https://www.observatoire-comifac.net/mapproxy/service';\nwindow.urls.ofac_tiles = 'tiles/';\nwindow.urls.dopa_geoserver = 'https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms';\n\n// Mapping\nwindow.WebMapping = {};\nwindow.WebMapping.Leaflet = require('./mapping_leaflet/utils.js');\nwindow.WebMapping.Leaflet.Layers = require('./mapping_leaflet/layers.js');\nwindow.WebMapping.Mapbox = require('./mapping_mapbox/utils.js');\nwindow.WebMapping.Mapbox.Layers = require('./mapping_mapbox/layers.js');\nrequire('./mapping_mapbox/platform.js');\nrequire('./mapping_mapbox/demo.js');\nrequire('./mapping_mapbox/demo_card.js');\n","export default {\n\n    props:{\n        opacity: {\n            type: Number,\n            default: 0.6\n        }\n    },\n\n    methods: {\n\n        __normalize(numbers, max){\n            max = max || Math.max(...numbers)\n            if(!isNaN(max) && max>0){\n                let ratio = max / 100;\n                numbers = numbers.map(v => Math.round(v / ratio));\n            }\n            return numbers;\n        },\n\n        __classify(numbers, num_steps=4){\n            let classify = function(num_steps){\n                return function(number) {\n                    if (number === null) {\n                        return null;\n                    }\n                    let class_index = 0;\n                    let i = 0;\n                    while (i < 100) {\n                        if (number > i && number <= i + 100 / num_steps) {\n                            return class_index;\n                        }\n                        i = i + 100 / num_steps;\n                        class_index++;\n                    }\n                    return 0;\n                };\n            };\n            return numbers.map(classify(num_steps));\n        },\n\n\n        choropleth(data, palette){\n            let keys = [],\n                values = [];\n            Object.entries(data).forEach(function(item){\n                keys.push(item[0]);\n                values.push(item[1]);\n            });\n            values = this.__normalize(values);\n            values = this.__classify(values, palette.length);\n            data = _.zipObject(keys, values);\n            return data;\n        }\n\n    }\n}","export default {\n\n    methods: {\n\n        toggle_component(component){\n            this.$store.commit('visible_components/toggle', component);\n        },\n\n        show_component(component){\n            this.$store.commit('visible_components/show', component);\n        },\n\n        hide_component(component){\n            this.$store.commit('visible_components/hide', component);\n        },\n\n        is_component_visible: function(component){\n            return this.$store.getters['visible_components/is_component_visible'](component)\n        },\n\n    }\n\n}\n","module.exports = {\n\n    tileSize: 1024,\n\n    /**\n     * Get MapProxy wms layer\n     * @param layer_name\n     * @param label\n     * @param custom_attributes\n     * @returns {*}\n     */\n    mapproxy_wms: function(layer_name, label = null, custom_attributes = {}){\n        let self = this;\n        let options = {\n            layers: layer_name,\n            format: 'image/png',\n            transparent: true,\n            tileSize: self.tileSize,\n            label: label\n        };\n        if(!_.isEmpty(custom_attributes)){\n            for (let [key, value] of Object.entries(custom_attributes)) {\n                options[key] = value;\n            }\n        }\n        return window.Leaflet.tileLayer.wms(window.urls.ofac_mapproxy, options);\n    },\n\n    vector_tiles: function(layer_name, label = null, custom_attributes = {}) {\n\n        let bounds = window.Leaflet.latLngBounds(\n            window.Leaflet.latLng(-11.125875, 5.566434),\n            window.Leaflet.latLng(17.936017, 30.837150)\n        );\n\n        return window.Leaflet.vectorGrid.protobuf('https://h03-stg-ofac.jrc.it/tiles/'+layer_name+'/{z}/{x}/{y}.pbf', {\n            vectorTileLayerStyles: {\n                protected_area: {\n                    color: '#ff6666',\n                    opacity: 0.6,\n                    weight: 2,\n                    fillColor: '#ffaaaa',\n                    fillOpacity: 0.6,\n                    fill: true\n                }\n            },\n            bounds: bounds,\n            key: 'protected_area',\n            id: 'protected_area',\n            label: label\n        });\n    },\n\n    /**\n     * Get OFAC wms layer\n     * @param layer_name\n     * @param label\n     * @param custom_attributes\n     * @returns {*}\n     */\n    mapserver_wms: function(layer_name, label = null, custom_attributes = {}){\n        let self = this;\n        let options = {\n            layers: layer_name,\n            format: 'image/png',\n            transparent: true,\n            tileSize: self.tileSize,\n            label: label\n        };\n        if(!_.isEmpty(custom_attributes)){\n            for (let [key, value] of Object.entries(custom_attributes)) {\n                options[key] = value;\n            }\n        }\n        return window.Leaflet.tileLayer.wms(window.urls.ofac_mapserver, options);\n    },\n\n    /**\n     * Get Mapbox layer\n     * @param style\n     * @param label\n     */\n    mapbox_layer: function(style, label = null){\n\n        style = style==='streets' ? 'streets-v11' : style;\n        style = style==='light' ? 'light-v10' : style;\n        style = style==='satellite' ? 'satellite-v9' : style;\n\n        let self = this;\n        return window.Leaflet.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token='+window.mapbox_access_token, {\n            tileSize: 512,\n            maxZoom: 18,\n            zoomOffset: -1,\n            id: 'mapbox/'+style,\n            attribution: 'Map data &copy; <a target=\"_blank\" href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, ' +\n                '<a target=\"_blank\" href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, ' +\n                'Imagery  <a target=\"_blank\" href=\"http://mapbox.com\">Mapbox</a>',\n            label: label\n        });\n    },\n\n    /**\n     * Projects platform: get marker-cluster\n     * @param points\n     */\n    project_markerCluster: function(points, label){\n        let marker_cluster = window.Leaflet.markerClusterGroup({\n            iconCreateFunction: function (cluster) {\n                return new window.Leaflet.DivIcon({\n                    html: '<div><span class=\"marker-count\">' + cluster.getChildCount() + '</span></div>', className: 'marker-cluster', iconSize: new window.Leaflet.Point(40, 40)\n                });\n            },\n            showCoverageOnHover: false,\n            zoomToBoundsOnClick: false,\n            label: label\n        });\n\n        points.forEach(function(project) {\n            let [lat, lon, popupInfo, title, status] = project;\n            let icon = 'asterisk';\n            let color = 'lightgray';\n            if(status==='finished'){\n                color = 'red';\n            } else if(status==='ongoing'){\n                color = 'green';\n            } else if(status==='planned'){\n                color = 'orange';\n            }\n\n            let marker = window.Leaflet.marker(new window.Leaflet.LatLng(lat, lon), {\n                title: title,\n                icon: window.Leaflet.AwesomeMarkers.icon({\n                    markerColor: color,\n                    prefix: 'fa',\n                    icon: icon,\n                    iconColor: 'white'\n                })\n            });\n\n            marker.bindPopup(popupInfo);\n            marker_cluster.addLayer(marker);\n\n        });\n\n        return marker_cluster;\n    },\n\n    getLayersForLeaftletControl(layers){\n        let result = {};\n        layers.forEach(function(layer) {\n            result[layer.options.label] = layer;\n        });\n        return result;\n    },\n\n};","export default {\n\n    data() {\n        return {\n            api_library_cancel_token: null,\n            library: {\n                data: null,\n                count: null,\n                show: false,\n                loading: false,\n                show_filters: false,\n                filter_domain: null\n            }\n        }\n    },\n\n    computed:{\n        filtered_library: function () {\n            let _this = this;\n            let list = this.library.data;\n            // sort\n            list = _.orderBy(list, 'title', 'asc')\n            // filter\n            list = list.filter(function (item) {\n                if(_this.library.filter_domain!==null && _this.library.filter_domain!==''){\n                    return item.domains.includes(_this.library.filter_domain);\n                }\n                return true;\n            });\n            return list;\n        }\n    },\n\n    methods: {\n\n        refreshLibrary(){\n            let _this = this;\n\n            this.library.loading = false;\n            this.library.data = null;\n            this.library.count = null;\n            this.library.show = null;\n\n            // Cancel previous API request if still running\n            if (this.api_library_cancel_token !== null) {\n                this.api_library_cancel_token();\n            }\n\n            if(this.theme!==null && (\n                this.level==='regional'\n                || (this.level==='national' && this.site!==null)\n                || (this.level==='concessions' && this.site!==null)\n                || (this.level==='protected_areas' && this.site!==null)\n            )) {\n\n                this.library.loading = true;\n\n                window.axios({\n                    method: 'post',\n                    url: window.Laravel.baseUrl + 'api/analysis/library',\n                    data: {\n                        _token: _this.csrf,\n                        level: _this.level,\n                        site: _this.site || null,\n                        domain: _this.theme || null,\n                    },\n                    cancelToken: new window.axios.CancelToken(function executor(c) {\n                        _this.api_library_cancel_token = c;\n                    }),\n                })\n                    .then(function (response) {\n                        console.log('Request to library API executed');\n                        if (!_.isEmpty(response.data)) {\n                            _this.library.data = typeof response.data === \"string\" ? JSON.parse(response.data) : response.data;\n                            _this.library.count = _this.library.data.length;\n\n                        } else {\n                            _this.library.count = 0;\n                        }\n                    })\n                    .catch(function (error) {\n                        if (window.axios.isCancel(error)) {\n                            console.log('Request to library API canceled. No more necessary');\n                        } else {\n                            console.log(error);\n                        }\n                    })\n                    .finally(function () {\n                        _this.library.loading = false;\n                        _this.api_library_cancel_token = null;\n                    });\n            }\n        }\n\n    }\n}","export default {\n\n    data() {\n        return {\n            api_projects_cancel_token: null,\n            projects: {\n                data: null,\n                count: null,\n                show: false,\n                loading: false,\n                show_filters: false,\n                filter_domain: null,\n                filter_status: null\n            }\n        }\n    },\n\n\n    computed:{\n        filtered_projects: function () {\n            let _this = this;\n            let list = this.projects.data;\n            // sort\n            list = _.orderBy(list, 'Acronym', 'asc')\n            // filter\n            list = list.filter(function (item) {\n                if(_this.projects.filter_domain!==null && _this.projects.filter_domain!==''){\n                    return item.domains.includes(_this.projects.filter_domain);\n                }\n                if(_this.projects.filter_status!==null && _this.projects.filter_status!==''){\n                    return item.status.includes(_this.projects.filter_status);\n                }\n                return true;\n            });\n            return list;\n        }\n    },\n\n    methods: {\n\n        refreshProjects(){\n            let _this = this;\n\n            this.projects.loading = null;\n            this.projects.data = null;\n            this.projects.count = null;\n            this.projects.show = null;\n\n            // Cancel previous API request if still running\n            if (this.api_projects_cancel_token !== null) {\n                this.api_projects_cancel_token();\n            }\n\n            if(this.theme!==null && (\n                this.level==='regional'\n                || (this.level==='national' && this.site!==null)\n                || (this.level==='concessions' && this.site!==null)\n                || (this.level==='protected_areas' && this.site!==null)\n            )) {\n\n                this.projects.loading = true;\n\n                window.axios({\n                    method: 'post',\n                    url: window.Laravel.baseUrl + 'api/analysis/projects',\n                    data: {\n                        _token: _this.csrf,\n                        level: _this.level,\n                        site: _this.site || null,\n                        domain: _this.theme || null,\n                    },\n                    cancelToken: new window.axios.CancelToken(function executor(c) {\n                        _this.api_projects_cancel_token = c;\n                    }),\n                })\n                    .then(function (response) {\n                        console.log('Request to projects API executed');\n                        if (!_.isEmpty(response.data)) {\n                            _this.projects.data = typeof response.data === \"string\" ? JSON.parse(response.data) : response.data;\n                            _this.projects.count = _this.projects.data.length;\n                        } else {\n                            _this.projects.count = 0;\n                        }\n\n                    })\n                    .catch(function (error) {\n                        if (window.axios.isCancel(error)) {\n                            console.log('Request to projects API canceled. No more necessary');\n                        } else {\n                            console.log(error);\n                        }\n                    })\n                    .finally(function () {\n                        _this.projects.loading = false;\n                        _this.api_projects_cancel_token = null;\n                    });\n\n            }\n\n        },\n\n    }\n}","export default {\n\n    data() {\n        return {\n            api_cancel_token: null,\n            api_loading: false,\n            card_has_data: false,\n            api_data: {\n                forest_management: {\n                    regional: null,\n                    national: null,\n                    concessions: null,\n                },\n                biodiversity: {\n                    regional: null,\n                    national: null,\n                    klc: null,\n                    protected_areas: null,\n                },\n                convergence_plan: {\n                    regional: null\n                },\n            }\n        }\n    },\n\n    methods:{\n\n        // ##############################################\n        // ##########  Retrieve DATA from APIs ##########\n        // ##############################################\n\n        getCachedData() {\n            if(this.level!=='local'){\n                if(this.level==='regional'){\n                    return this.api_data[this.theme][this.level];\n                } else if(this.site!==null\n                    && this.api_data[this.theme][this.level] !== null\n                    && this.api_data[this.theme][this.level].hasOwnProperty(this.site)\n                ){\n                    return this.api_data[this.theme][this.level][this.site];\n                }\n            }\n            return null;\n        },\n\n        getDataAttribute(attribute_path){\n            let data = this.getCachedData();\n            if(data!==null){\n                // return data[attribute_path];\n                let deepFind = function(data, attribute_path){\n                    let paths = attribute_path.split('.');\n                    let current = data;\n                    for (let i=0; i<paths.length; ++i) {\n                        if (!current.hasOwnProperty(paths[i])) {\n                            return null;\n                        } else {\n                            current = current[paths[i]];\n                        }\n                    }\n                    return current;\n                };\n                return deepFind(data, attribute_path)\n            }\n            return null;\n        },\n\n        getAPI(site){\n            let _this = this;\n            this.site = site || null;\n\n            this.api_loading = true;\n            this.card_has_data = false;\n            this.selected_card = this.theme + '_' + this.level;\n\n            // set API url\n            let url = this.level === 'regional'\n                ? 'api/analysis/' + this.theme + '/' + this.level\n                : 'api/analysis/' + this.theme + '/' + this.level + '/' + site;\n\n            // set API responseCallback\n            let responseCallback = function(response){\n                // store response in api_data\n                if (_this.level === 'regional') {\n                    _this.api_data[_this.theme][_this.level] = response;\n                } else {\n                    _this.api_data[_this.theme][_this.level] = _this.api_data[_this.theme][_this.level] || {};\n                    _this.api_data[_this.theme][_this.level][site] = response;\n                }\n                // set related cards + button\n                Vue.nextTick(function () {\n                    _this.selected_card = _this.theme + '_' + _this.level;\n                    _this.card_has_data = true;\n                    Vue.nextTick(function () {\n                        let first_button = document.querySelectorAll('.card-api.card-' + _this.theme + '_' + _this.level + ' .selection:first-of-type')[0];\n                        if (first_button) {\n                            _this.selected_card_button = first_button.getAttribute('data-card-key');\n                        }\n                    });\n                });\n            }\n\n            this.__retrieveAPI(url, responseCallback);\n\n        },\n\n        __retrieveAPI(url, responseCallback){\n            let _this = this;\n\n            // Cancel previous API request if still running\n            if (this.api_cancel_token !== null) {\n                this.api_cancel_token();\n            }\n\n            // Check and retrieve cached data (if any)\n            let cached = this.getCachedData();\n            if(cached!==null){\n                console.log('Request to API not executed. Data retrieved from cache.');\n                responseCallback(JSON.parse(JSON.stringify(cached)));\n                this.finallyCallback();\n                return;\n            }\n\n            window.axios({\n                method: 'post',\n                url: window.Laravel.baseUrl + url,\n                data: {\n                    _token: _this.csrf,\n                },\n                cancelToken: new window.axios.CancelToken(function executor(c) {\n                    _this.api_cancel_token = c;\n                }),\n            })\n                .then(function (response) {\n                    console.log('Request to API executed');\n                    responseCallback(response.data);\n                })\n                .catch(function (error) {\n                    if (window.axios.isCancel(error)) {\n                        console.log('Request to API canceled. No more necessary', error.message);\n                    } else {\n                        console.log(error);\n                    }\n                })\n                .finally(function () {\n                    _this.finallyCallback();\n                });\n        },\n\n        finallyCallback(){\n            this.api_cancel_token = null;\n            this.api_loading = false;\n            this.removeLayerPopup();\n        }\n\n    }\n}\n","\nimport map from './mixins/map.mixin';\nimport library from './mixins/library.mixin';\nimport projects from './mixins/projects.mixin';\nimport api from './mixins/api.mixin';\n\nimport utils from './mixins/utils/utils.mixin';\nimport choropleth from './mixins/utils/choropleth.mixin';\n\nimport layers_interactivity from './mixins/layers/interactivity.mixin';\nimport visible_components from \"./mixins/visible_components\";\nimport visible_components_store from \"./store_modules/visible_components\";\n\nwindow.AnalyticalPlatform = Vue.extend({\n\n    mixins: [\n        map,\n        library,\n        projects,\n        api,\n        utils,\n        layers_interactivity,\n        choropleth,\n        visible_components\n    ],\n\n    store: new window.Vuex.Store({\n        modules: {\n            visible_components: visible_components_store\n        }\n    }),\n\n    created(){\n        this.theme = this.theme==='' ? null : this.theme;\n        this.level = this.level==='' ? null : this.level;\n        this.site = this.site==='' ? null : this.site;\n    },\n\n    data: function () {\n        return {\n\n            Locale: window.Locale,\n            csrf: window.Laravel.csrfToken,\n\n            zoomBBoxPadding: 75, // in pixels\n\n            // UI selections\n            selected_card: false,\n            selected_card_button: null,\n        }\n    },\n\n    watch: {\n        theme: function(){\n            this.reset();\n            this.level = null;\n            this.site = null;\n            this.refresh();\n            if(this.theme==='convergence_plan'){\n                this.level = 'regional';\n                this.getAPI();\n            }\n        },\n        level: function(){\n            this.site = null;\n            this.reset();\n            this.refresh();\n            if(this.level==='regional'){\n                this.getAPI();\n            }\n        },\n        site: function (value) {\n            this.reset();\n            this.refresh();\n            if(this.level==='national' || this.site!==null){\n                this.getAPI(this.site);\n            }\n        }\n    },\n\n    mounted(){\n        this.initMap();\n        this.refreshLibrary();\n        this.refreshProjects();\n        this.map_loading = false;\n        this.api_loading = false;\n    },\n\n    methods: {\n\n        reset(){\n            // console.log('level changed |', 'theme: '+this.theme, ', level: '+this.level, ', site: '+this.site);\n            this.show_layer_selector = false;\n            this.removeLayerPopup();\n            this.selected_card = null;\n            this.selected_card_button = null;\n        },\n\n        refresh(){\n            if (this.level==='regional') {\n                this.zoomToBBox(this.extents['comifac']);\n            } else if(this.level==='national' && this.site!==null) {\n                this.zoomToBBox(this.extents[this.level][this.site]);\n            }\n            this.refreshExclusiveLayers();\n            this.refreshThematicLayer();\n            this.refreshInteractiveLayers();\n            this.refreshLibrary();\n            this.refreshProjects();\n        },\n\n\n        // ##############################################\n        // ###############  Manage cards  ###############\n        // ##############################################\n\n        toggleLayersSelector(){\n            this.show_layer_selector = !this.show_layer_selector;\n            if(this.show_layer_selector){\n                this.library.show = false;\n                this.projects.show = false;\n            }\n        },\n\n        toggleLibrary(){\n            this.library.show = !this.library.show;\n            if(this.library.show){\n                this.show_layer_selector = false;\n                this.projects.show = false;\n            }\n        },\n\n        toggleProjects(){\n            this.projects.show = !this.projects.show;\n            if(this.projects.show){\n                this.show_layer_selector = false;\n                this.library.show = false;\n            }\n        },\n\n        showCardButton(button) {\n            let _this = this;\n            this.library.show = false;\n            this.projects.show = false;\n            if(this.selected_card_button!==null){\n                $('.collapse').collapse('hide'); // necessary 'cause there's a conflict between bootstrap4 and VueJS in accordion body\n            }\n\n            this.selected_card_button = null;\n            Vue.nextTick(function () {\n                if(_this.selected_card_button!==button){\n                    _this.selected_card_button = button;\n                }\n            });\n        },\n\n    }\n\n});\n","export default {\n\n    data() {\n        return {\n            map: null,\n            extents: null,\n            map_loading: false,\n            zoomBBoxPadding: 75, // in pixels\n\n            all_layers: {},\n            thematic_layer: null,   // layer associated with current theme/level selection\n            exclusive_active_layer: null,\n\n            // layer selector\n            show_layer_selector: true,\n            close_layer_selector_onclick: true,\n            layers_selected: 0\n        }\n    },\n\n\n    methods: {\n\n        setLoading(){\n            let _this = this;\n            this.map.on('dataloading', function () {\n                _this.map_loading = true;\n            });\n            this.map.on('data', function () {\n                if(_this.map.areTilesLoaded()){\n                    _this.map_loading = false;\n                }\n            });\n            this.map.on('error', function () {\n                _this.map_loading = false;\n            });\n        },\n\n        // ##########################################\n        // ##############  Manage map  ##############\n        // ##########################################\n\n        initMap: function () {\n            let _this = this;\n\n            // Initialize map\n            this.map = new window.mapboxgl.Map({\n                container: 'platform_map',\n                style: 'mapbox://styles/mapbox/streets-v11',\n                bounds: this.__getBounds(this.extents['comifac']),\n                minZoom: 3,\n                maxZoom: 12\n            });\n\n            // Add navigation control\n            this.map.addControl(new window.mapboxgl.NavigationControl({\n                showCompass: false\n            }), 'top-right');\n\n            // Add events\n            this.map.on('click', function (e) {\n                if (_this.close_layer_selector_onclick) {\n                    _this.show_layer_selector = false;\n                }\n            });\n\n            // Set loading spinner events\n            this.setLoading();\n\n            this.map.on('load', function () {\n\n                // Add default sources\n                _this.map.addSource('countries', window.WebMapping.Mapbox.mapbox_vector_source('countries'));\n                _this.map.addSource('protected_areas', window.WebMapping.Mapbox.mapbox_vector_source('protected_areas', '2021-05-05'));\n\n                // Add countries borders and mask outer regions\n                _this.addLayerToMap(_this.all_layers['comifac_mask']);\n                _this.addLayerToMap(_this.all_layers['comifac_eez']);\n                _this.addLayerToMap(_this.all_layers['countries']);\n            });\n\n        },\n\n        __getBounds(extent){\n            return new window.mapboxgl.LngLatBounds(\n                new window.mapboxgl.LngLat(extent['minx'], extent['miny']),\n                new window.mapboxgl.LngLat(extent['maxx'], extent['maxy'])\n            )\n        },\n\n        zoomToBBox(bbox){\n            this.map.fitBounds(this.__getBounds(bbox), { padding: this.zoomBBoxPadding });\n        },\n\n        zoomToFeature(feature){\n            let bbox = window.Turf.bbox({\n                type: 'FeatureCollection',\n                features: [\n                    feature\n                ]\n            });\n            this.map.fitBounds(bbox, { padding: this.zoomBBoxPadding });\n        },\n\n        // #########################################\n        // ############  Manage layers  ############\n        // #########################################\n\n        layerIsOnMap(layer_id){\n            if(this.map!==null){\n                return typeof this.map.getLayer(layer_id) !== 'undefined'\n            }\n            return false\n        },\n\n        addLayerToMap(layer){\n            if(!this.layerIsOnMap(layer.id)){\n                // If \"exclusive\" layer\n                if(layer.hasOwnProperty('exclusive') && layer.exclusive) {\n                    // remove existing exclusive layer and add to store\n                    if(this.exclusive_active_layer!==null){\n                        this.removeLayerFromMap(this.exclusive_active_layer);\n                    }\n                    this.exclusive_active_layer = layer;\n                    // hide thematic layer (if any)\n                    if(this.thematic_layer!==null){\n                        this.removeLayerFromMap(this.thematic_layer);\n                    }\n                }\n                // \"data-driven\": only add layer to map\n                if(layer.hasOwnProperty('data_driven') && layer.data_driven){\n                    this.map.addLayer(layer);\n                }\n                // standard layer\n                else {\n                    this.map.addLayer(layer);\n                    window.vueBus.$emit('toggle_layer', layer.id, true);\n                    this.refreshInteractiveLayers();  // must be called after adding main layer\n                    this.sortLayers();\n                }\n            }\n        },\n\n        removeLayerFromMap(layer){\n            if(this.layerIsOnMap(layer.id)){\n                // If \"exclusive\" layer\n                if(layer.hasOwnProperty('exclusive') && layer.exclusive) {\n                    // remove from store\n                    this.exclusive_active_layer = null;\n                    // show thematic layer (if any)\n                    if(this.thematic_layer!==null){\n                        this.addLayerToMap(this.thematic_layer);\n                    }\n                }\n                // \"data-driven\": only remove from map\n                if(layer.hasOwnProperty('data_driven') && layer.data_driven){\n                    this.map.removeLayer(layer.id);\n                    window.vueBus.$emit('toggle_layer', layer.id, false);\n                }\n                // standard layer\n                else {\n                    this.map.removeLayer(layer.id);\n                    window.vueBus.$emit('toggle_layer', layer.id, false);\n                    this.refreshInteractiveLayers(); // must be called before removing source\n                    if(layer.id!=='countries' && layer.id!=='protected_areas'){\n                        this.map.removeSource(layer.id);\n                    }\n                    this.sortLayers();\n                }\n            }\n        },\n\n        toggleLayer(layer){\n            if(this.layerIsOnMap(layer.id)){\n                this.removeLayerFromMap(layer);\n            } else {\n                this.addLayerToMap(layer);\n            }\n        },\n\n        sortLayers(){\n            // Move countries borders\n            if(this.layerIsOnMap('countries')) {\n                this.map.moveLayer('countries');\n            }\n            if(this.layerIsOnMap('comifac_eez')) {\n                this.map.moveLayer('comifac_eez');\n            }\n            // Move all layers defined in this.all_layers\n            for (let layer_id in this.all_layers) {\n                if (this.all_layers.hasOwnProperty(layer_id)) {\n                    if (this.layerIsOnMap(layer_id)) {\n                        this.map.moveLayer(layer_id);\n                    }\n                    if (this.layerIsOnMap(this.__grayedLayerId(layer_id))) {\n                        this.map.moveLayer(this.__grayedLayerId(layer_id));\n                    }\n                    if (this.layerIsOnMap(this.__maskedLayerId(layer_id))) {\n                        this.map.moveLayer(this.__maskedLayerId(layer_id));\n                    }\n                }\n            }\n\n            // Move countries mask\n            if(this.layerIsOnMap('countries_mask')) {\n                this.map.moveLayer('countries_mask');\n            }\n        },\n\n        refreshThematicLayer(){\n            if(this.thematic_layer!==null){\n                this.removeLayerFromMap(this.thematic_layer);\n                this.thematic_layer = null;\n            }\n            if(this.level==='concessions'\n                || this.level==='klc'\n                || this.level==='protected_areas'){\n                let layer = this.all_layers[this.level];\n                this.thematic_layer = layer;\n                this.addLayerToMap(layer);\n            }\n        },\n\n        refreshExclusiveLayers(){\n            if(this.exclusive_active_layer!==null){\n                this.removeLayerFromMap(this.exclusive_active_layer);\n                this.exclusive_active_layer = null;\n            }\n        },\n\n        refreshInteractiveLayers(){}\n\n    }\n}\n","module.exports = {\n\n    // ##########  Base maps - backgrounds  ##########\n\n    mapbox_streets:  window.WebMapping.Leaflet.mapbox_layer('streets', Locale.getLabel('mapping.layers.mapbox_streets')),\n    mapbox_light:  window.WebMapping.Leaflet.mapbox_layer('light', Locale.getLabel('mapping.layers.mapbox_light')),\n    mapbox_satellite:  window.WebMapping.Leaflet.mapbox_layer('satellite', Locale.getLabel('mapping.layers.mapbox_satellite')),\n\n    // ##########  Rasters  ##########\n\n    comifac:  window.WebMapping.Leaflet.mapproxy_wms('comifac', Locale.getLabel('mapping.layers.comifac'),{\n        attribution: '<div style=\"width: 800px;\">' +\n                    '<b>Image source de base :</b> Verhegghen, A., Mayaux, P., de Wasseige, C., and Defourny, P.: ' +\n                    'Mapping Congo Basin vegetation types from 300 m and 1 km multi-sensor time series for carbon stocks' +\n                    ' and forest areas estimation, Biogeosciences, 9, 5061-5079, doi:10.5194/bg-9-5061-2012, 2012. ' +\n                    '<a target=\"_blank\" href=\"http://www.biogeosciences.net/9/5061/2012/bg-9-5061-2012.html\">biogeosciences.net</a>'+\n                    '<br/><b>Donnes sources ajoutes :</b> SRTM de la Nasa, OSM et OFAC'+\n                    '<br/><b>Traite :</b> Mai 2015, <a target=\"_blank\" href=\"/docs/atlas/mapsteps.pdf\">Etapes de ralisation</a></div>',\n    }),\n    spotvgt:  window.WebMapping.Leaflet.mapproxy_wms('spotvgt', Locale.getLabel('mapping.layers.spotvgt')),\n    modis:  window.WebMapping.Leaflet.mapproxy_wms('modis', Locale.getLabel('mapping.layers.modis')),\n    srtm:  window.WebMapping.Leaflet.mapproxy_wms('srtm', Locale.getLabel('mapping.layers.srtm')),\n    glc2000:  window.WebMapping.Leaflet.mapproxy_wms('glc2000', Locale.getLabel('mapping.layers.glc2000')),\n    congo_basin_vegetation_map:  window.WebMapping.Leaflet.mapproxy_wms('congo_basin_vegetation_map', Locale.getLabel('mapping.layers.congo_basin_vegetation_map')),\n    total_carbon:  window.WebMapping.Leaflet.mapproxy_wms('total_carbon', Locale.getLabel('mapping.layers.total_carbon')),\n\n    // ##########  External Resources  ##########\n\n    tree_cover: window.Leaflet.tileLayer.wms(\"http://50.18.182.188:6080/arcgis/services/TreeCover2000/ImageServer/WMSServer?\", {\n        layers: '0',\n        format: 'image/png',\n        transparent: true,\n        attribution: 'Hansen/UMD/Google/USGS/NASA, Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>',\n        label: 'Tree Cover (2000-2010)',\n        abstract: encodeURI('Hansen, M. C., P. V. Potapov, R. Moore, M. Hancher, S. A. Turubanova, A. Tyukavina, D. Thau, S. V. Stehman, S. J. Goetz, ' +\n            'T. R. Loveland, A. Kommareddy, A. Egorov, L. Chini, C. O. Justice, and J. R. G. Townshend. 2013. <b>High-Resolution Global Maps of 21st-Century Forest Cover Change.</b> ' +\n            'Science 342 (15 November): 85053. Data available on-line from: <a href=\"https://glad.umd.edu/dataset/global-2010-tree-cover-30-m\" target=\"_blank\">https://glad.umd.edu/dataset/global-2010-tree-cover-30-m</a>. ' +\n            'Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    }),\n    intact_forest: window.Leaflet.tileLayer('https://storage.googleapis.com/earthenginepartners-hansen/tiles/intact_forest_2016/{z}/{x}/{y}.png?', {\n        attribution: '<a href=\"http://www.intactforests.org\" target=\"_blank\">Intact Forest Landscape (IFL)</a>',\n        label: 'Intact Forest Landscapes (IFL 2000-2016)',\n        abstract: encodeURI('Greenpeace, University of Maryland, World Resources Institute and Transparent World. Intact Forest Landscapes. 2000/2013/2016 ' +\n            'Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    }),\n\n    // ##########  Overlays  ##########\n\n    borders: window.WebMapping.Leaflet.mapserver_wms('borders', null, {}),\n    landscapes: window.WebMapping.Leaflet.mapproxy_wms('landscapes', Locale.getLabel('entities.landscape', 2)),\n    klc: window.WebMapping.Leaflet.mapproxy_wms('klc', Locale.getLabel('entities.klc', 2)),\n    concessions: window.WebMapping.Leaflet.mapserver_wms('concessions', Locale.getLabel('form/concession.concession', 2)),\n    protected_areas: window.WebMapping.Leaflet.mapproxy_wms('protected_areas', Locale.getLabel('form/protected_area.protected_area', 2))\n\n\n};\n"],"sourceRoot":""}
{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/assets/js/mapping_mapbox/utils.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/utils/utils.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/layers.js","webpack:///./resources/assets/js/mapping.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/utils/choropleth.mixin.js","webpack:///./resources/assets/js/mapping_leaflet/utils.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/library.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/projects.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/api.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/layers/interactivity.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/mixins/layers/data_driven.mixin.js","webpack:///./resources/assets/js/mapping_mapbox/platform.js","webpack:///./resources/assets/js/mapping_leaflet/layers.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","tileSize","internalTileSize","mapbox_vector_layer","layer_id","label","type","paint","source_id","mapbox_vector_source","window","Laravel","baseUrl","urls","ofac_tiles","mapbox_wms_source","wms_url","layer","tile_size","replace","wms","cache","custom_attributes","url","ofac_mapproxy","ofac_mapserver","options","_","isEmpty","entries","props","red_yellow_green","Array","default","rainbow_10","methods","generateGradientPalette","num_colors","colors","this","gradstop","stops","inputFormat","colorArray","generateColorPalette","slice","comifac","WebMapping","Mapbox","Locale","getLabel","attribution","spotvgt","modis","srtm","glc2000","congo_basin_vegetation_map","total_carbon","land_fragmentation","id","source","abstract","land_degradation","soil_organic_carbon","above_ground_carbon","tree_cover","encodeURI","intact_forest","comifac_mask","comifac_eez","countries","landscapes","klc","concessions","protected_areas","mapbox_access_token","process","dopa_geoserver","Leaflet","require","Layers","opacity","Number","__normalize","numbers","max","Math","isNaN","ratio","map","v","round","__classify","num_steps","classify","number","class_index","choropleth","data","palette","keys","values","forEach","item","push","length","zipObject","mapproxy_wms","layer_name","self","layers","format","transparent","tileLayer","vector_tiles","bounds","latLngBounds","latLng","vectorGrid","protobuf","vectorTileLayerStyles","protected_area","color","weight","fillColor","fillOpacity","fill","mapserver_wms","mapbox_layer","style","maxZoom","zoomOffset","project_markerCluster","points","marker_cluster","markerClusterGroup","iconCreateFunction","cluster","DivIcon","html","getChildCount","className","iconSize","Point","showCoverageOnHover","zoomToBoundsOnClick","project","lat","lon","popupInfo","title","status","marker","LatLng","icon","AwesomeMarkers","markerColor","prefix","iconColor","bindPopup","addLayer","getLayersForLeaftletControl","result","api_library_cancel_token","library","count","show","loading","show_filters","filter_domain","computed","filtered_library","_this","list","orderBy","filter","domains","includes","refreshLibrary","theme","level","site","axios","method","_token","csrf","domain","cancelToken","CancelToken","then","response","console","log","JSON","parse","error","isCancel","api_projects_cancel_token","projects","filter_status","filtered_projects","refreshProjects","api_cancel_token","api_loading","card_has_data","api_data","forest_management","regional","national","biodiversity","visible_hidden_components","mounted","vueBus","$on","component","toggle_hidden_component","splice","indexOf","is_hidden_component_visible","getCachedData","getDataAttribute","attribute_path","paths","split","current","deepFind","getAPI","selected_card","__retrieveAPI","Vue","nextTick","first_button","document","querySelectorAll","selected_card_button","getAttribute","responseCallback","cached","stringify","finallyCallback","message","removeLayerPopup","hover_feature","popup","popup_features","click_coords","setHighlight","condition","filter_attribute","filter_value","layerIsOnMap","addGrayedLayer","setFilter","__grayedLayerId","removeGrayedLayer","removeLayer","setMask","addMaskedLayer","__maskedLayerId","removeMaskedLayer","mouseOver","on","evt","features","feature_id","_featureHoverOff","_featureHoverOn","__setFeatureHover","hover","setFeatureState","sourceLayer","getCanvas","cursor","hoverOnRelatedLayer","hover_layer_id","related_layer_id","hover_layer_filter_attribute","related_layer_filter_attribute","related_features_ids","querySourceFeatures","properties","showPopup","lngLat","feature","a","popup_content","feature_index","featurePopupDescription","featurePopupActions","mapboxgl","Popup","setLngLat","setHTML","addTo","popup_item","popup_features_index","button","querySelector","addEventListener","event","zoomToFeature","remove","name_fr","checked","source_layer_id","layer_paint","toggle","Platform","extend","mixins","api","utils","layers_interactivity","data_driven_layers","created","extents","csrfToken","zoomBBoxPadding","backgrounds","dopa_resources","external_resources","overlays","mask_applied","map_loading","show_layer_selector","watch","reset","zoomToBBox","refreshInteractiveLayers","initMap","setLoading","areTilesLoaded","Map","container","__getBounds","minZoom","addControl","NavigationControl","showCompass","e","addSource","getLayer","group_key","$emit","sortLayers","removeSource","toggleLayer","moveLayer","extent","LngLatBounds","LngLat","fitBounds","padding","bbox","Turf","toggleLayersSelector","toggleLibrary","toggleProjects","showCardButton","$","collapse","mapbox_streets","mapbox_light","mapbox_satellite","borders"],"mappings":"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","file":"/mapping.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = {\n\n    tileSize: 1024,\n    internalTileSize: 1024,\n\n    mapbox_vector_layer: function(layer_id, label = null, type = 'fill', paint = {}, source_id = null) {\n        return {\n            'id': layer_id,\n            'type': type,\n            'source': source_id || module.exports.mapbox_vector_source(layer_id),\n            'source-layer': source_id || layer_id,\n            'paint': paint,\n            label: label\n        }\n    },\n\n    mapbox_vector_source: function(layer_id){\n        return {\n            'type': 'vector',\n            'tiles': [\n                window.Laravel.baseUrl + window.urls.ofac_tiles + layer_id + '/{z}/{x}/{y}.pbf'\n            ]\n        }\n    },\n\n    mapbox_wms_source: function(wms_url, layer, tile_size){\n\n        wms_url     = wms_url.replace(/\\??$/, '?');\n        tile_size   = tile_size || module.exports.tileSize;\n\n        let options = wms_url +\n            'service=WMS' +\n            '&version=1.1.1' +\n            '&request=GetMap' +\n            '&format=image/png' +\n            '&transparent=true' +\n            '&styles=' +\n            '&layers=' + layer +\n            '&width=' + tile_size +\n            '&height=' + tile_size +\n            '&bbox={bbox-epsg-3857}' +\n            '&srs=EPSG:3857';\n        return {\n            'type': 'raster',\n            'tiles': [options],\n            'tileSize': tile_size\n        };\n    },\n\n    /**\n     * Get MapServer/MapProxy wms layer\n     * @param layer_id\n     * @param label\n     * @param cache [boolean] (true if should pass by MapProxy)\n     * @param custom_attributes\n     * @returns {*}\n     */\n    wms: function(layer_id, label = null, cache = true, custom_attributes = {}){\n        let url = cache===true\n            ? window.urls.ofac_mapproxy\n            : window.urls.ofac_mapserver;\n\n        url = url.replace(/\\??$/, '?');\n\n        let options = {\n            'id': layer_id,\n            'type': 'raster',\n            'source': module.exports.mapbox_wms_source(url, layer_id, module.exports.internalTileSize),\n            label: label\n        };\n        if(!_.isEmpty(custom_attributes)){\n            for (let [key, value] of Object.entries(custom_attributes)) {\n                options[key] = value;\n            }\n        }\n        return options;\n    },\n\n};","export default {\n\n    props:{\n        red_yellow_green: {\n            type: Array,\n            default: () => [\n                '#ce2e29',  // $darkRed\n                '#f9c74f',\n                '#007233'   // $darkGreen\n            ]\n        },\n        rainbow_10:{\n            type: Array,\n            default: () => [\n                '#404887',\n                '#3374ff',\n                '#43aa8b',\n                '#90be6d',\n                '#f9c74f',\n                '#f3722c',\n                '#f94144',\n                '#d35e9d',\n                '#ad7af6',\n                '#e7c1cb',\n                '#c9bcb5',\n                '#5f6269',\n            ]\n        }\n    },\n\n    methods: {\n\n        /**\n         * Generate a gradient color palette (using https://github.com/Siddharth11/gradstop)\n         *\n         * @param num_colors\n         * @param colors\n         */\n        generateGradientPalette(num_colors, colors) {\n            colors = colors || this.red_yellow_green;\n            return gradstop({\n                stops: num_colors,\n                inputFormat: 'hex',\n                colorArray: colors\n            });\n        },\n\n        /**\n         * Return a palette from the given array of colors\n         *\n         * @param num_colors\n         * @param colors\n         * @returns {T[]}\n         */\n        generateColorPalette(num_colors, colors) {\n            colors = colors || this.rainbow_10;\n            return colors.slice(0, num_colors);\n        }\n\n\n    }\n}","module.exports = {\n\n    // ##########  Rasters  ##########\n\n    comifac:  window.WebMapping.Mapbox.wms('comifac', Locale.getLabel('mapping.layers.comifac'),true, {\n        attribution: '<div style=\"width: 800px;\">' +\n            '<b>Image source de base :</b> Verhegghen, A., Mayaux, P., de Wasseige, C., and Defourny, P.: ' +\n            'Mapping Congo Basin vegetation types from 300 m and 1 km multi-sensor time series for carbon stocks' +\n            ' and forest areas estimation, Biogeosciences, 9, 5061-5079, doi:10.5194/bg-9-5061-2012, 2012. ' +\n            '<a target=\"_blank\" href=\"http://www.biogeosciences.net/9/5061/2012/bg-9-5061-2012.html\">biogeosciences.net</a>'+\n            '<br/><b>Données sources ajoutées :</b> SRTM de la Nasa, OSM et OFAC'+\n            '<br/><b>Traitée :</b> Mai 2015, <a target=\"_blank\" href=\"/docs/atlas/mapsteps.pdf\">Etapes de réalisation</a></div>',\n    }),\n    spotvgt:  window.WebMapping.Mapbox.wms('spotvgt', Locale.getLabel('mapping.layers.spotvgt'), true),\n    modis:  window.WebMapping.Mapbox.wms('modis', Locale.getLabel('mapping.layers.modis'), true),\n    srtm:  window.WebMapping.Mapbox.wms('srtm', Locale.getLabel('mapping.layers.srtm'), true),\n    glc2000:  window.WebMapping.Mapbox.wms('glc2000', Locale.getLabel('mapping.layers.glc2000'), true),\n    congo_basin_vegetation_map:  window.WebMapping.Mapbox.wms('congo_basin_vegetation_map', Locale.getLabel('mapping.layers.congo_basin_vegetation_map'), true),\n    total_carbon:  window.WebMapping.Mapbox.wms('total_carbon', Locale.getLabel('mapping.layers.total_carbon'), true),\n\n\n    // ##########  DOPA Resources  ##########\n\n    land_fragmentation: {\n        id: 'land_fragmentation',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'land_fragmentation'),\n        label: 'Fragmentation des terres',\n        abstract: '&copy; Services DOPA'\n        // abstract: 'Landscape pattern and fragmentation classes computed for the years 1995, 2000, 2005, 2010 and 2015. &copy; DOPA Services'\n    },\n    land_degradation: {\n        id: 'land_degradation',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'LPD'),\n        label: 'Dégradation des terres',\n        abstract: '&copy; Services DOPA'\n        // abstract: 'Changes over 15 years (1999-2013) in the health and productive capacity of the land. &copy; DOPA Services'\n    },\n    soil_organic_carbon: {\n        id: 'soil_organic_carbon',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'soil_organic_carbon'),\n        label: 'Carbone organique du sol',\n        abstract: '&copy; Services DOPA'\n        // abstract: 'Country statistics for the amount of soil organic carbon (0-30 cm depth). &copy; DOPA Services'\n    },\n    above_ground_carbon: {\n        id: 'above_ground_carbon',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms?', 'above_ground_carbon'),\n        label: 'Carbon au-dessous du sol',\n        abstract: '&copy; Services DOPA'\n        // abstract: 'Country statistics for the amount of soil organic carbon (0-30 cm depth). &copy; DOPA Services'\n    },\n\n    // ##########  Other External Resources  ##########\n\n    tree_cover: {\n        id: 'tree_cover',\n        type: 'raster',\n        source: window.WebMapping.Mapbox.mapbox_wms_source('http://50.18.182.188:6080/arcgis/services/TreeCover2000/ImageServer/WMSServer?', 0),\n        label: 'Tree Cover (2000-2010)',\n        abstract: encodeURI('Hansen, M. C., P. V. Potapov, R. Moore, M. Hancher, S. A. Turubanova, A. Tyukavina, D. Thau, S. V. Stehman, S. J. Goetz, ' +\n            'T. R. Loveland, A. Kommareddy, A. Egorov, L. Chini, C. O. Justice, and J. R. G. Townshend. 2013. <b>“High-Resolution Global Maps of 21st-Century Forest Cover Change.”</b> ' +\n            'Science 342 (15 November): 850–53. Data available on-line from: <a href=\"https://glad.umd.edu/dataset/global-2010-tree-cover-30-m\" target=\"_blank\">https://glad.umd.edu/dataset/global-2010-tree-cover-30-m</a>. ' +\n            'Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    },\n    intact_forest: {\n        id: \"intact_forest\",\n        type: \"raster\",\n        source: {\n            \"type\": \"raster\",\n            \"tiles\": [\"https://storage.googleapis.com/earthenginepartners-hansen/tiles/intact_forest_2016/{z}/{x}/{y}.png\"],\n            \"attribution\": 'Map tiles by <a target=\"_top\" rel=\"noopener\" href=\"http://stamen.com\">Stamen Design</a>, under <a target=\"_top\" rel=\"noopener\" href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a target=\"_top\" rel=\"noopener\" href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a target=\"_top\" rel=\"noopener\" href=\"http://creativecommons.org/licenses/by-sa/3.0\">CC BY SA</a>'\n        },\n        label: 'Intact Forest Landscapes (IFL 2000-2016)',\n        abstract: encodeURI('Greenpeace, University of Maryland, World Resources Institute and Transparent World. “Intact Forest Landscapes. 2000/2013/2016” ' +\n            'Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    },\n\n    // ##########  Overlays  ##########\n    comifac_mask:  window.WebMapping.Mapbox.wms('comifac_mask', null, true),\n\n    comifac_eez: window.WebMapping.Mapbox.mapbox_vector_layer('comifac_eez', null, 'fill', {\n        'fill-color':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 'rgba(255, 255, 255, 0.3)',\n                'rgba(255, 255, 255, 0)',\n            ],\n        'fill-outline-color': 'rgba(60, 150, 255, 0.8)'\n    }),\n\n    countries: window.WebMapping.Mapbox.mapbox_vector_layer('countries', null, 'fill', {\n        'fill-color':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 'rgba(255, 255, 255, 0.3)',\n                'rgba(255, 255, 255, 0)',\n            ],\n        'fill-outline-color': 'rgba(0, 50, 0, 0.8)'\n    },\n    'countries'),\n\n    landscapes: window.WebMapping.Mapbox.mapbox_vector_layer('landscapes', Locale.getLabel('mapping.platform.sites.landscapes', 2), 'fill', {\n        'fill-color': 'rgb(255, 255, 0)',\n        'fill-opacity':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 0.8,\n                0.5\n            ]\n    }),\n    klc: window.WebMapping.Mapbox.mapbox_vector_layer('klc', Locale.getLabel('mapping.platform.sites.klc', 2), 'fill', {\n        'fill-color': 'rgb(255, 155, 0)',\n        'fill-opacity':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 0.8,\n                0.5\n            ]\n    }),\n    concessions: window.WebMapping.Mapbox.mapbox_vector_layer('concessions', Locale.getLabel('mapping.platform.sites.concessions', 2), 'fill', {\n        'fill-color': 'rgb(163, 113, 66)',\n        'fill-opacity':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 0.8,\n                0.5\n            ]\n    }),\n    protected_areas: window.WebMapping.Mapbox.mapbox_vector_layer('protected_areas', Locale.getLabel('mapping.platform.sites.protected_areas', 2), 'fill', {\n        'fill-color': 'rgb(0, 115, 40)',\n        'fill-opacity':\n            [\"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false], 0.8,\n                0.5\n            ]\n    },\n    'protected_areas')\n\n\n};","// Environment variables\nwindow.mapbox_access_token = process.env.MIX_MAPBOX_ACCESS_TOKEN;\n\n// Urls\nwindow.urls = window.urls || {};\nwindow.urls.ofac_mapserver = 'https://www.observatoire-comifac.net/geo/mapserver/' + 'ofacgeo.php?';\nwindow.urls.ofac_mapproxy = 'https://www.observatoire-comifac.net/mapproxy/service';\nwindow.urls.ofac_tiles = 'tiles/';\nwindow.urls.dopa_geoserver = 'https://geospatial.jrc.ec.europa.eu/geoserver/dopa_explorer_3/wms';\n\n// Mapping\nwindow.WebMapping = {};\nwindow.WebMapping.Leaflet = require('./mapping_leaflet/utils.js');\nwindow.WebMapping.Leaflet.Layers = require('./mapping_leaflet/layers.js');\nwindow.WebMapping.Mapbox = require('./mapping_mapbox/utils.js');\nwindow.WebMapping.Mapbox.Layers = require('./mapping_mapbox/layers.js');\nrequire('./mapping_mapbox/platform.js');","export default {\n\n    props:{\n        opacity: {\n            type: Number,\n            default: 0.6\n        }\n    },\n\n    methods: {\n\n        __normalize(numbers, max){\n            max = max || Math.max(...numbers)\n            if(!isNaN(max) && max>0){\n                let ratio = max / 100;\n                numbers = numbers.map(v => Math.round(v / ratio));\n            }\n            return numbers;\n        },\n\n        __classify(numbers, num_steps=4){\n            let classify = function(num_steps){\n                return function(number) {\n                    if (number === null) {\n                        return null;\n                    }\n                    let class_index = 0;\n                    let i = 0;\n                    while (i < 100) {\n                        if (number > i && number <= i + 100 / num_steps) {\n                            return class_index;\n                        }\n                        i = i + 100 / num_steps;\n                        class_index++;\n                    }\n                    return 0;\n                };\n            };\n            return numbers.map(classify(num_steps));\n        },\n\n\n        choropleth(data, palette){\n            let keys = [],\n                values = [];\n            Object.entries(data).forEach(function(item){\n                keys.push(item[0]);\n                values.push(item[1]);\n            });\n            values = this.__normalize(values);\n            values = this.__classify(values, palette.length);\n            data = _.zipObject(keys, values);\n            return data;\n        }\n\n    }\n}","module.exports = {\n\n    tileSize: 1024,\n\n    /**\n     * Get MapProxy wms layer\n     * @param layer_name\n     * @param label\n     * @param custom_attributes\n     * @returns {*}\n     */\n    mapproxy_wms: function(layer_name, label = null, custom_attributes = {}){\n        let self = this;\n        let options = {\n            layers: layer_name,\n            format: 'image/png',\n            transparent: true,\n            tileSize: self.tileSize,\n            label: label\n        };\n        if(!_.isEmpty(custom_attributes)){\n            for (let [key, value] of Object.entries(custom_attributes)) {\n                options[key] = value;\n            }\n        }\n        return window.Leaflet.tileLayer.wms(window.urls.ofac_mapproxy, options);\n    },\n\n    vector_tiles: function(layer_name, label = null, custom_attributes = {}) {\n\n        let bounds = window.Leaflet.latLngBounds(\n            window.Leaflet.latLng(-11.125875, 5.566434),\n            window.Leaflet.latLng(17.936017, 30.837150)\n        );\n\n        return window.Leaflet.vectorGrid.protobuf('https://h03-stg-ofac.jrc.it/tiles/'+layer_name+'/{z}/{x}/{y}.pbf', {\n            vectorTileLayerStyles: {\n                protected_area: {\n                    color: '#ff6666',\n                    opacity: 0.6,\n                    weight: 2,\n                    fillColor: '#ffaaaa',\n                    fillOpacity: 0.6,\n                    fill: true\n                }\n            },\n            bounds: bounds,\n            key: 'protected_area',\n            id: 'protected_area',\n            label: label\n        });\n    },\n\n    /**\n     * Get OFAC wms layer\n     * @param layer_name\n     * @param label\n     * @param custom_attributes\n     * @returns {*}\n     */\n    mapserver_wms: function(layer_name, label = null, custom_attributes = {}){\n        let self = this;\n        let options = {\n            layers: layer_name,\n            format: 'image/png',\n            transparent: true,\n            tileSize: self.tileSize,\n            label: label\n        };\n        if(!_.isEmpty(custom_attributes)){\n            for (let [key, value] of Object.entries(custom_attributes)) {\n                options[key] = value;\n            }\n        }\n        return window.Leaflet.tileLayer.wms(window.urls.ofac_mapserver, options);\n    },\n\n    /**\n     * Get Mapbox layer\n     * @param style\n     * @param label\n     */\n    mapbox_layer: function(style, label = null){\n\n        style = style==='streets' ? 'streets-v11' : style;\n        style = style==='light' ? 'light-v10' : style;\n        style = style==='satellite' ? 'satellite-v9' : style;\n\n        let self = this;\n        return window.Leaflet.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token='+window.mapbox_access_token, {\n            tileSize: 512,\n            maxZoom: 18,\n            zoomOffset: -1,\n            id: 'mapbox/'+style,\n            attribution: 'Map data &copy; <a target=\"_blank\" href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, ' +\n                '<a target=\"_blank\" href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, ' +\n                'Imagery © <a target=\"_blank\" href=\"http://mapbox.com\">Mapbox</a>',\n            label: label\n        });\n    },\n\n    /**\n     * Projects platform: get marker-cluster\n     * @param points\n     */\n    project_markerCluster: function(points, label){\n        let marker_cluster = window.Leaflet.markerClusterGroup({\n            iconCreateFunction: function (cluster) {\n                return new window.Leaflet.DivIcon({\n                    html: '<div><span class=\"marker-count\">' + cluster.getChildCount() + '</span></div>', className: 'marker-cluster', iconSize: new window.Leaflet.Point(40, 40)\n                });\n            },\n            showCoverageOnHover: false,\n            zoomToBoundsOnClick: false,\n            label: label\n        });\n\n        points.forEach(function(project) {\n            let [lat, lon, popupInfo, title, status] = project;\n            let icon = 'asterisk';\n            let color = 'lightgray';\n            if(status==='finished'){\n                color = 'red';\n            } else if(status==='ongoing'){\n                color = 'green';\n            } else if(status==='planned'){\n                color = 'orange';\n            }\n\n            let marker = window.Leaflet.marker(new window.Leaflet.LatLng(lat, lon), {\n                title: title,\n                icon: window.Leaflet.AwesomeMarkers.icon({\n                    markerColor: color,\n                    prefix: 'fa',\n                    icon: icon,\n                    iconColor: 'white'\n                })\n            });\n\n            marker.bindPopup(popupInfo);\n            marker_cluster.addLayer(marker);\n\n        });\n\n        return marker_cluster;\n    },\n\n    getLayersForLeaftletControl(layers){\n        let result = {};\n        layers.forEach(function(layer) {\n            result[layer.options.label] = layer;\n        });\n        return result;\n    },\n\n};","export default {\n\n    data() {\n        return {\n            api_library_cancel_token: null,\n            library: {\n                data: null,\n                count: null,\n                show: false,\n                loading: false,\n                show_filters: false,\n                filter_domain: null\n            }\n        }\n    },\n\n    computed:{\n        filtered_library: function () {\n            let _this = this;\n            let list = this.library.data;\n            // sort\n            list = _.orderBy(list, 'title', 'asc')\n            // filter\n            list = list.filter(function (item) {\n                if(_this.library.filter_domain!==null && _this.library.filter_domain!==''){\n                    return item.domains.includes(_this.library.filter_domain);\n                }\n                return true;\n            });\n            return list;\n        }\n    },\n\n    methods: {\n\n        refreshLibrary(){\n            let _this = this;\n\n            this.library.loading = false;\n            this.library.data = null;\n            this.library.count = null;\n            this.library.show = null;\n\n            // Cancel previous API request if still running\n            if (this.api_library_cancel_token !== null) {\n                this.api_library_cancel_token();\n            }\n\n            if(this.theme!==null && (\n                this.level==='regional'\n                || (this.level==='national' && this.site!==null)\n                || (this.level==='concessions' && this.site!==null)\n                || (this.level==='protected_areas' && this.site!==null)\n            )) {\n\n                this.library.loading = true;\n\n                window.axios({\n                    method: 'post',\n                    url: window.Laravel.baseUrl + 'api/analysis/library',\n                    data: {\n                        _token: _this.csrf,\n                        level: _this.level,\n                        site: _this.site || null,\n                        domain: _this.theme || null,\n                    },\n                    cancelToken: new window.axios.CancelToken(function executor(c) {\n                        _this.api_library_cancel_token = c;\n                    }),\n                })\n                    .then(function (response) {\n                        console.log('Request to library API executed');\n                        if (!_.isEmpty(response.data)) {\n                            _this.library.data = typeof response.data === \"string\" ? JSON.parse(response.data) : response.data;\n                            _this.library.count = _this.library.data.length;\n\n                        } else {\n                            _this.library.count = 0;\n                        }\n                    })\n                    .catch(function (error) {\n                        if (window.axios.isCancel(error)) {\n                            console.log('Request to library API canceled. No more necessary');\n                        } else {\n                            console.log(error);\n                        }\n                    })\n                    .finally(function () {\n                        _this.library.loading = false;\n                        _this.api_library_cancel_token = null;\n                    });\n            }\n        }\n\n    }\n}","export default {\n\n    data() {\n        return {\n            api_projects_cancel_token: null,\n            projects: {\n                data: null,\n                count: null,\n                show: false,\n                loading: false,\n                show_filters: false,\n                filter_domain: null,\n                filter_status: null\n            }\n        }\n    },\n\n\n    computed:{\n        filtered_projects: function () {\n            let _this = this;\n            let list = this.projects.data;\n            // sort\n            list = _.orderBy(list, 'Acronym', 'asc')\n            // filter\n            list = list.filter(function (item) {\n                if(_this.projects.filter_domain!==null && _this.projects.filter_domain!==''){\n                    return item.domains.includes(_this.projects.filter_domain);\n                }\n                if(_this.projects.filter_status!==null && _this.projects.filter_status!==''){\n                    return item.status.includes(_this.projects.filter_status);\n                }\n                return true;\n            });\n            return list;\n        }\n    },\n\n    methods: {\n\n        refreshProjects(){\n            let _this = this;\n\n            this.projects.loading = null;\n            this.projects.data = null;\n            this.projects.count = null;\n            this.projects.show = null;\n\n            // Cancel previous API request if still running\n            if (this.api_projects_cancel_token !== null) {\n                this.api_projects_cancel_token();\n            }\n\n            if(this.theme!==null && (\n                this.level==='regional'\n                || (this.level==='national' && this.site!==null)\n                || (this.level==='concessions' && this.site!==null)\n                || (this.level==='protected_areas' && this.site!==null)\n            )) {\n\n                this.projects.loading = true;\n\n                window.axios({\n                    method: 'post',\n                    url: window.Laravel.baseUrl + 'api/analysis/projects',\n                    data: {\n                        _token: _this.csrf,\n                        level: _this.level,\n                        site: _this.site || null,\n                        domain: _this.theme || null,\n                    },\n                    cancelToken: new window.axios.CancelToken(function executor(c) {\n                        _this.api_projects_cancel_token = c;\n                    }),\n                })\n                    .then(function (response) {\n                        console.log('Request to projects API executed');\n                        if (!_.isEmpty(response.data)) {\n                            _this.projects.data = typeof response.data === \"string\" ? JSON.parse(response.data) : response.data;\n                            _this.projects.count = _this.projects.data.length;\n                        } else {\n                            _this.projects.count = 0;\n                        }\n\n                    })\n                    .catch(function (error) {\n                        if (window.axios.isCancel(error)) {\n                            console.log('Request to projects API canceled. No more necessary');\n                        } else {\n                            console.log(error);\n                        }\n                    })\n                    .finally(function () {\n                        _this.projects.loading = false;\n                        _this.api_projects_cancel_token = null;\n                    });\n\n            }\n\n        },\n\n    }\n}","export default {\n\n    data() {\n        return {\n            api_cancel_token: null,\n            api_loading: false,\n            card_has_data: false,\n            api_data: {\n                forest_management: {\n                    regional: null,\n                    national: null,\n                    concessions: null,\n                },\n                biodiversity: {\n                    regional: null,\n                    national: null,\n                    protected_areas: null,\n                },\n            },\n            visible_hidden_components: []\n        }\n    },\n\n    mounted(){\n        let _this = this;\n\n        // call toggle functions\n        window.vueBus.$on('toggle_hidden_component', function (component) {\n            _this.toggle_hidden_component(component);\n        });\n    },\n\n    methods:{\n\n        toggle_hidden_component(component){\n            if(this.visible_hidden_components.includes(component)){\n                this.visible_hidden_components.splice(this.visible_hidden_components.indexOf(component), 1);\n            } else {\n                this.visible_hidden_components.push(component);\n            }\n        },\n\n        is_hidden_component_visible(component){\n            return this.visible_hidden_components.includes(component);\n        },\n\n        // ##############################################\n        // ##########  Retrieve DATA from APIs ##########\n        // ##############################################\n\n        getCachedData() {\n            if(this.level!=='local'){\n                if(this.level==='regional'){\n                    return this.api_data[this.theme][this.level];\n                } else if(this.site!==null\n                    && this.api_data[this.theme][this.level] !== null\n                    && this.api_data[this.theme][this.level].hasOwnProperty(this.site)\n                ){\n                    return this.api_data[this.theme][this.level][this.site];\n                }\n            }\n            return null;\n        },\n\n        getDataAttribute(attribute_path){\n            let data = this.getCachedData();\n            if(data!==null){\n                // return data[attribute_path];\n                let deepFind = function(data, attribute_path){\n                    let paths = attribute_path.split('.');\n                    let current = data;\n                    for (let i=0; i<paths.length; ++i) {\n                        if (!current.hasOwnProperty(paths[i])) {\n                            return null;\n                        } else {\n                            current = current[paths[i]];\n                        }\n                    }\n                    return current;\n                };\n                return deepFind(data, attribute_path)\n            }\n            return null;\n        },\n\n        getAPI(site){\n            let _this = this;\n            this.site = site || null;\n\n            this.api_loading = true;\n            this.card_has_data = false;\n            this.selected_card = this.theme + '_' + this.level;\n            this.visible_hidden_components = [];\n\n            // set API url\n            let url = this.level === 'regional'\n                ? 'api/analysis/' + this.theme + '/' + this.level\n                : 'api/analysis/' + this.theme + '/' + this.level + '/' + site;\n\n            // set API responseCallback\n            let responseCallback = function(response){\n                // store response in api_data\n                if (_this.level === 'regional') {\n                    _this.api_data[_this.theme][_this.level] = response;\n                } else {\n                    _this.api_data[_this.theme][_this.level] = _this.api_data[_this.theme][_this.level] || {};\n                    _this.api_data[_this.theme][_this.level][site] = response;\n                }\n                // set related cards + button\n                Vue.nextTick(function () {\n                    _this.selected_card = _this.theme + '_' + _this.level;\n                    _this.card_has_data = true;\n                    Vue.nextTick(function () {\n                        let first_button = document.querySelectorAll('.card-api.card-' + _this.theme + '_' + _this.level + ' .selection:first-of-type')[0];\n                        if (first_button) {\n                            _this.selected_card_button = first_button.getAttribute('data-card-key');\n                        }\n                    });\n                });\n            }\n\n            this.__retrieveAPI(url, responseCallback);\n\n        },\n\n        __retrieveAPI(url, responseCallback){\n            let _this = this;\n\n            // Cancel previous API request if still running\n            if (this.api_cancel_token !== null) {\n                this.api_cancel_token();\n            }\n\n            // Check and retrieve cached data (if any)\n            let cached = this.getCachedData();\n            if(cached!==null){\n                console.log('Request to API not executed. Data retrieved from cache.');\n                responseCallback(JSON.parse(JSON.stringify(cached)));\n                this.finallyCallback();\n                return;\n            }\n\n            window.axios({\n                method: 'post',\n                url: window.Laravel.baseUrl + url,\n                data: {\n                    _token: _this.csrf,\n                },\n                cancelToken: new window.axios.CancelToken(function executor(c) {\n                    _this.api_cancel_token = c;\n                }),\n            })\n                .then(function (response) {\n                    console.log('Request to API executed');\n                    responseCallback(response.data);\n                })\n                .catch(function (error) {\n                    if (window.axios.isCancel(error)) {\n                        console.log('Request to API canceled. No more necessary', error.message);\n                    } else {\n                        console.log(error);\n                    }\n                })\n                .finally(function () {\n                    _this.finallyCallback();\n                });\n        },\n\n        finallyCallback(){\n            this.api_cancel_token = null;\n            this.api_loading = false;\n            this.removeLayerPopup();\n        }\n\n    }\n}","export default {\n\n    data() {\n        return {\n            hover_feature: [],\n            popup: null,\n            popup_features: [],\n            click_coords: null\n        }\n    },\n\n    methods: {\n\n        // ########  Highlight filtered features  ######\n\n        setHighlight(layer_id, condition, filter_attribute, filter_value){\n            if(this.layerIsOnMap(layer_id)) {\n                if (condition) {\n                    this.addGrayedLayer(layer_id);\n                    this.map.setFilter(layer_id, ['==', filter_attribute, filter_value]);\n                    this.map.setFilter(this.__grayedLayerId(layer_id), ['!=', filter_attribute, filter_value]);\n                } else {\n                    this.removeGrayedLayer(layer_id);\n                    this.map.setFilter(layer_id, true);\n                }\n            } else {\n                this.removeGrayedLayer(layer_id);\n            }\n        },\n\n        __grayedLayerId(layer_id){\n            return layer_id + '_grayed';\n        },\n\n        addGrayedLayer(layer_id){\n            if(!this.layerIsOnMap(this.__grayedLayerId(layer_id))){\n                this.map.addLayer({\n                    'id': this.__grayedLayerId(layer_id),\n                    'type': 'fill',\n                    'source': layer_id,\n                    'source-layer': layer_id,\n                    'paint': {\n                        \"fill-color\": 'rgba(180, 180, 180, 0.5)',\n                    },\n                });\n            }\n        },\n\n        removeGrayedLayer(layer_id){\n            if(this.layerIsOnMap(this.__grayedLayerId(layer_id))){\n                this.map.removeLayer(this.__grayedLayerId(layer_id));\n            }\n        },\n\n\n        // ########  Mask unwanted features  ######\n\n        setMask(layer_id, condition, filter_attribute, filter_value){\n            if(this.layerIsOnMap(layer_id)) {\n                if (filter_value !== null && condition) {\n                    this.addMaskedLayer(layer_id);\n                    this.map.setFilter(this.__maskedLayerId(layer_id), ['!=', filter_attribute, filter_value]);\n                } else {\n                    this.removeMaskedLayer(layer_id);\n                }\n            } else {\n                this.removeMaskedLayer(layer_id);\n            }\n        },\n\n        __maskedLayerId(layer_id){\n            return layer_id + '_masked';\n        },\n\n        addMaskedLayer(layer_id){\n            if(!this.layerIsOnMap(this.__maskedLayerId(layer_id))){\n                this.map.addLayer({\n                    'id': this.__maskedLayerId(layer_id),\n                    'type': 'fill',\n                    'source': layer_id,\n                    'source-layer': layer_id,\n                    'paint': {\n                        \"fill-color\": 'rgba(0, 0, 0, 0.5)',\n                        \"fill-outline-color\": 'rgba(0, 0, 0, 0.5)',\n                    },\n                });\n            }\n        },\n\n        removeMaskedLayer(layer_id){\n            if(this.layerIsOnMap(this.__maskedLayerId(layer_id))){\n                this.map.removeLayer(this.__maskedLayerId(layer_id));\n            }\n        },\n\n        // ########  Highlight on mouse hover  ######\n\n        mouseOver(layer_id){\n            let _this = this;\n            if(_this.layerIsOnMap(layer_id)) {\n                _this.hover_feature[layer_id] = _this.hover_feature[layer_id] || [];\n                this.map.on('mousemove', layer_id, function (evt) {\n                    if (!_this.hover_feature[layer_id].includes(evt.features[0].id)) {\n                        _this.hover_feature[layer_id].forEach(function(feature_id){\n                            _this._featureHoverOff(layer_id, feature_id);\n                        });\n                        _this._featureHoverOn( layer_id, evt.features[0].id);\n                    }\n                });\n                this.map.on('mouseleave', layer_id, function () {\n                    _this.hover_feature[layer_id].forEach(function(feature_id){\n                        _this._featureHoverOff(layer_id, feature_id);\n                    });\n                });\n            }\n        },\n\n        __setFeatureHover(feature_id, layer_id, hover){\n            this.map.setFeatureState({\n                source: layer_id,\n                sourceLayer: layer_id,\n                id: feature_id\n            }, {\n                hover: hover\n            });\n        },\n\n        _featureHoverOn(layer_id, feature_id){\n            this.hover_feature[layer_id].push(feature_id);\n            this.__setFeatureHover(feature_id, layer_id, true);\n            this.map.getCanvas().style.cursor = 'pointer';\n        },\n        _featureHoverOff(layer_id, feature_id){\n            if (this.hover_feature[layer_id].includes(feature_id)) {\n                this.__setFeatureHover(feature_id, layer_id, false);\n                this.map.getCanvas().style.cursor = '';\n                this.hover_feature[layer_id].splice(this.hover_feature[layer_id].indexOf(feature_id), 1);\n            }\n        },\n\n        hoverOnRelatedLayer(hover_layer_id, related_layer_id, hover_layer_filter_attribute, related_layer_filter_attribute){\n            let _this = this;\n            if(_this.layerIsOnMap(hover_layer_id) && _this.layerIsOnMap(related_layer_id)) {\n                _this.hover_feature[hover_layer_id] = _this.hover_feature[hover_layer_id] || [];\n                _this.hover_feature[related_layer_id] = _this.hover_feature[related_layer_id] || [];\n                this.map.on('mousemove', hover_layer_id, function (evt) {\n                    let related_features_ids = _this.map.querySourceFeatures(related_layer_id, {\n                        sourceLayer: related_layer_id,\n                        filter: ['==', related_layer_filter_attribute, evt.features[0].properties[hover_layer_filter_attribute]]\n                    }).map(({ id }) => id);\n                    _this.hover_feature[related_layer_id].forEach(function(feature_id){\n                        if(!related_features_ids.includes(feature_id)){\n                            _this._featureHoverOff(related_layer_id, feature_id);\n                        }\n                    });\n                    related_features_ids.forEach(function (feature_id) {\n                        if (!_this.hover_feature[related_layer_id].includes(feature_id)) {\n                            _this._featureHoverOn(related_layer_id, feature_id);\n                        }\n                    });\n                });\n                this.map.on('mouseleave', hover_layer_id, function () {\n                    _this.hover_feature[related_layer_id].forEach(function(feature_id){\n                        _this._featureHoverOff(related_layer_id, feature_id);\n                    });\n                });\n            }\n        },\n\n        // ########  Popup  ######\n\n        showPopup(layer_id){\n            let _this = this;\n            if(_this.layerIsOnMap(layer_id)) {\n                _this.map.on('click', layer_id, function (evt) {\n                    _this.removeLayerPopup(evt);\n                    // Collect all clicked features\n                    _this.click_coords = evt.lngLat;\n                    evt.features.forEach(function (feature) {\n                        let ids = _this.popup_features.map(a => a.id);\n                        if (!ids.includes(feature.id)) {\n                            _this.popup_features.push(feature);\n                        }\n                    });\n\n                    // Build popUp content\n                    let popup_content = '';\n                    _this.popup_features.forEach(function (feature, feature_index) {\n                        popup_content +=\n                            '<div class=\"popup-item\" id=\"popup-item_' + feature_index + '\">' +\n                            _this.featurePopupDescription(feature) +\n                            _this.featurePopupActions(feature) +\n                            '</div>';\n                    });\n\n                    _this.popup = new window.mapboxgl.Popup()\n                        .setLngLat(evt.lngLat)\n                        .setHTML(popup_content)\n                        .addTo(_this.map);\n\n                    // Add manually the EventListener. v-on directive on button added by mapboxgl.Popup (after VUeJS render) does not work.\n                    document.querySelectorAll('.mapboxgl-popup .popup-item')\n                        .forEach(function (popup_item) {\n                            let popup_features_index = popup_item.id.replace('popup-item_', '');\n                            let button = popup_item.querySelector('button.getAPI');\n                            if (button !== null) {\n                                button.addEventListener('click', (event) => {\n                                    let feature = _this.popup_features[popup_features_index];\n                                    _this.zoomToFeature(feature);\n                                    _this.getAPI(feature.id);\n                                });\n                            }\n                        });\n                });\n            }\n        },\n\n        removeLayerPopup(evt = null){\n            if(this.popup!==null){\n                this.popup.remove();\n            }\n            this.popup = null;\n            if(evt===null || (this.click_coords!=null && this.click_coords!==evt.lngLat)){\n                this.popup_features = [];\n            }\n        },\n\n        featurePopupDescription(feature){\n            // console.log(feature.properties);\n            if(feature.layer.id === 'countries'){\n                return '<i>' + this.Locale.getLabel('mapping.platform.sites.countries', 1) + '</i><br />' +\n                    '<b class=\"green\">' + feature.properties.name_fr + '</b>';\n            }\n            else{\n                return '<i>' + this.Locale.getLabel('mapping.platform.sites.'+feature.layer.id, 1) + '</i><br />' +\n                    '<b class=\"green\">' + feature.properties.name + '</b>';\n            }\n        },\n\n        featurePopupActions(feature){\n            if(feature.layer.id === this.level){\n                return '<div class=\"popup-footer\">' +\n                    '<button class=\"btn btn-sm act-btn-basic getAPI\">' + this.Locale.getLabel('mapping.platform.analysis') + '</button>' +\n                    '</div>';\n            }\n            return '';\n        },\n\n    }\n}","export default {\n\n    mounted(){\n        let _this = this;\n\n        // call toggle functions\n        window.vueBus.$on('toggleDataLayer', function (checked, layer_id, source_layer_id, layer_paint) {\n            _this.toggle(checked, layer_id, source_layer_id, layer_paint);\n        });\n    },\n\n    methods: {\n        toggle(toggle, layer_id, source_layer_id, layer_paint){\n            if(toggle){\n                this.map.addLayer(\n                    {\n                        'id': layer_id,\n                        'type': 'fill',\n                        'source': source_layer_id,\n                        'source-layer': source_layer_id,\n                        'paint': layer_paint\n                    }\n                );\n            } else {\n                this.map.removeLayer(layer_id);\n            }\n        },\n    }\n}","\nimport library from './mixins/library.mixin';\nimport projects from './mixins/projects.mixin';\nimport api from './mixins/api.mixin';\n\nimport utils from './mixins/utils/utils.mixin';\nimport choropleth from './mixins/utils/choropleth.mixin';\n\nimport layers_interactivity from './mixins/layers/interactivity.mixin';\nimport data_driven_layers from './mixins/layers/data_driven.mixin';\n\n\nwindow.WebMapping.Mapbox.Platform = Vue.extend({\n\n    mixins: [\n        library,\n        projects,\n        api,\n        utils,\n        layers_interactivity,\n        data_driven_layers,\n        choropleth\n    ],\n\n    created(){\n        this.theme = this.theme==='' ? null : this.theme;\n        this.level = this.level==='' ? null : this.level;\n        this.site = this.site==='' ? null : this.site;\n    },\n\n    data: function () {\n        return {\n            map: null,\n            extents: null,\n            Locale: window.Locale,\n            csrf: window.Laravel.csrfToken,\n\n            zoomBBoxPadding: 75, // in pixels\n\n            layers: {\n                backgrounds: {\n                    comifac: window.WebMapping.Mapbox.Layers.comifac,\n                    spotvgt: window.WebMapping.Mapbox.Layers.spotvgt,\n                    modis: window.WebMapping.Mapbox.Layers.modis,\n                    srtm: window.WebMapping.Mapbox.Layers.srtm,\n                    glc2000: window.WebMapping.Mapbox.Layers.glc2000,\n                    congo_basin_vegetation_map: window.WebMapping.Mapbox.Layers.congo_basin_vegetation_map,\n                    total_carbon: window.WebMapping.Mapbox.Layers.total_carbon,\n                },\n                dopa_resources: {\n                    land_fragmentation: window.WebMapping.Mapbox.Layers.land_fragmentation,\n                    land_degradation: window.WebMapping.Mapbox.Layers.land_degradation,\n                    soil_organic_carbon: window.WebMapping.Mapbox.Layers.soil_organic_carbon,\n                    above_ground_carbon: window.WebMapping.Mapbox.Layers.above_ground_carbon,\n                },\n                external_resources: {\n                    tree_cover: window.WebMapping.Mapbox.Layers.tree_cover,\n                    intact_forest: window.WebMapping.Mapbox.Layers.intact_forest,\n                },\n                overlays: {\n                    comifac_mask: window.WebMapping.Mapbox.Layers.comifac_mask,\n                    comifac_eez: window.WebMapping.Mapbox.Layers.comifac_eez,\n                    countries: window.WebMapping.Mapbox.Layers.countries,\n                    landscapes: window.WebMapping.Mapbox.Layers.landscapes,\n                    klc: window.WebMapping.Mapbox.Layers.klc,\n                    concessions: window.WebMapping.Mapbox.Layers.concessions,\n                    protected_areas: window.WebMapping.Mapbox.Layers.protected_areas\n                }\n            },\n            mask_applied: false,\n            map_loading: false,\n\n            // UI selections\n            show_layer_selector: false,\n            selected_card: false,\n            selected_card_button: null,\n\n        }\n    },\n\n    watch: {\n        theme: function(){\n            this.reset();\n            this.level = null;\n            this.site = null;\n            this.refreshLibrary();\n            this.refreshProjects();\n            // console.log('theme changed. |', 'theme: '+this.theme, ', level: '+this.level, ', site: '+this.site);\n        },\n        level: function(){\n            this.site = null;\n            // console.log('level changed |', 'theme: '+this.theme, ', level: '+this.level, ', site: '+this.site);\n            this.reset();\n            this.zoomToBBox();\n            this.refreshInteractiveLayers();\n            this.refreshLibrary();\n            this.refreshProjects();\n            if(this.level==='regional'){\n                this.getAPI();\n            }\n            if(this.level==='concessions' || this.level==='protected_areas'){\n                this.addLayer(this.level, 'overlays');\n            }\n        },\n        site: function (value) {\n            // console.log('site changed', 'theme: '+this.theme, 'level: '+this.level, 'site: '+this.site);\n            this.reset();\n            this.zoomToBBox();\n            this.refreshInteractiveLayers();\n            this.refreshLibrary();\n            this.refreshProjects();\n            if(this.level==='national' || this.site!==null){\n                this.getAPI(this.site);\n            }\n        }\n    },\n\n    mounted(){\n        this.initMap();\n        this.refreshLibrary();\n        this.refreshProjects();\n        this.map_loading = false;\n        this.api_loading = false;\n    },\n\n    methods: {\n\n        setLoading(){\n            let _this = this;\n            this.map.on('dataloading', function () {\n                _this.map_loading = true;\n            });\n            this.map.on('data', function () {\n                if(_this.map.areTilesLoaded()){\n                    _this.map_loading = false;\n                }\n            });\n            this.map.on('error', function () {\n                _this.map_loading = false;\n            });\n        },\n\n        reset(){\n            this.show_layer_selector = false;\n            this.removeLayerPopup();\n            this.selected_card = null;\n            this.selected_card_button = null;\n        },\n\n        // ###############################################\n        // ############  Manage map & layers  ############\n        // ###############################################\n\n        initMap(){\n            let _this = this;\n\n            // Initialize map\n            this.map = new window.mapboxgl.Map({\n                container: 'platform_map',\n                style: 'mapbox://styles/mapbox/streets-v11',\n                bounds: this.__getBounds(this.extents['comifac']),\n                minZoom: 3,\n                maxZoom: 12\n            });\n\n            // Add navigation control\n            this.map.addControl(new window.mapboxgl.NavigationControl({\n                showCompass: false\n            }), 'top-right');\n\n            // Add events\n            this.map.on('click', function (e) {\n                _this.show_layer_selector = false;\n            });\n\n            // Set loading spinner events\n            this.setLoading();\n\n            this.map.on('load', function(){\n\n                // Add default sources\n                _this.map.addSource('countries', window.WebMapping.Mapbox.mapbox_vector_source('countries'));\n                _this.map.addSource('protected_areas', window.WebMapping.Mapbox.mapbox_vector_source('protected_areas'));\n\n                // Add countries borders and mask outer regions\n                _this.addLayer('comifac_mask', 'overlays');\n                _this.addLayer('comifac_eez', 'overlays');\n                _this.addLayer('countries', 'overlays');\n            });\n\n        },\n\n        layerIsOnMap(layer_id){\n            if(this.map!==null){\n                return typeof this.map.getLayer(layer_id) !== 'undefined'\n            }\n            return false\n        },\n\n        addLayer(layer_id, group_key){\n            if(!this.layerIsOnMap(layer_id)){\n                this.map.addLayer(\n                    this.layers[group_key][layer_id]\n                );\n                window.vueBus.$emit('toggle_layer', layer_id, true);\n                this.refreshInteractiveLayers();  // must be called after adding main layer\n                this.sortLayers();\n            }\n        },\n\n        removeLayer(layer_id, group_key){\n            if(this.layerIsOnMap(layer_id)){\n                this.map.removeLayer(layer_id);\n                window.vueBus.$emit('toggle_layer', layer_id, false);\n                this.refreshInteractiveLayers(); // must be called before removing source\n                if(layer_id!=='countries' && layer_id!=='protected_areas'){\n                    this.map.removeSource(layer_id);\n                }\n                this.sortLayers();\n            }\n        },\n\n        toggleLayer(layer_id, group_key){\n            if(this.layerIsOnMap(layer_id)){\n                this.removeLayer(layer_id, group_key);\n            } else {\n                this.addLayer(layer_id, group_key);\n            }\n        },\n\n        sortLayers(){\n            // Move countries borders\n            if(this.layerIsOnMap('countries')) {\n                this.map.moveLayer('countries');\n            }\n            if(this.layerIsOnMap('comifac_eez')) {\n                this.map.moveLayer('comifac_eez');\n            }\n            // Move all layers defined in this.layers\n            for (let group_key in this.layers) {\n                if (this.layers.hasOwnProperty(group_key)) {\n                    for (let layer_id in this.layers[group_key]) {\n                        if (this.layers[group_key].hasOwnProperty(layer_id)){\n                            if(this.layerIsOnMap(layer_id)){\n                                this.map.moveLayer(layer_id);\n                            }\n                            if(this.layerIsOnMap(this.__grayedLayerId(layer_id))){\n                                this.map.moveLayer(this.__grayedLayerId(layer_id));\n                            }\n                            if(this.layerIsOnMap(this.__maskedLayerId(layer_id))){\n                                this.map.moveLayer(this.__maskedLayerId(layer_id));\n                            }\n                        }\n                    }\n                }\n            }\n            // Move countries mask\n            if(this.layerIsOnMap('countries_mask')) {\n                this.map.moveLayer('countries_mask');\n            }\n        },\n\n        __getBounds(extent){\n            return new window.mapboxgl.LngLatBounds(\n                new window.mapboxgl.LngLat(extent['minx'], extent['miny']),\n                new window.mapboxgl.LngLat(extent['maxx'], extent['maxy'])\n            )\n        },\n\n        /**\n         * Pan e zoom accoridng to level/site selection\n         */\n        zoomToBBox(){\n            if (this.level==='regional') {\n                this.map.fitBounds(this.__getBounds(this.extents['comifac']), { padding: this.zoomBBoxPadding });\n            } else if(this.level==='national' && this.site!==null) {\n                this.map.fitBounds(this.__getBounds( this.extents[this.level][this.site]), { padding: this.zoomBBoxPadding });\n            }\n        },\n\n        zoomToFeature(feature){\n            let bbox = window.Turf.bbox({\n                type: 'FeatureCollection',\n                features: [\n                    feature\n                ]\n            });\n            this.map.fitBounds(bbox, { padding: this.zoomBBoxPadding });\n        },\n\n\n\n        // #######################################################\n        // ######  Manage dynamic layers' interactivity  #########\n        // #######################################################\n\n        refreshInteractiveLayers(){\n            // countries\n            this.showPopup('countries');\n            this.mouseOver('countries');\n            this.hoverOnRelatedLayer('countries', 'comifac_eez', 'iso3', 'ISO_Ter1');\n            this.setMask('countries',\n                (this.level==='national' && this.site!==null),\n                'iso3',\n                this.site\n            );\n            // eez\n            this.mouseOver('comifac_eez');\n            this.hoverOnRelatedLayer('comifac_eez', 'countries', 'ISO_Ter1', 'iso3');\n            this.setMask('comifac_eez',\n                (this.level==='national' && this.site!==null),\n                'ISO_Ter1',\n                this.site\n            );\n            // landscapes\n            this.showPopup('landscapes');\n            this.mouseOver('landscapes');\n            // klc\n            this.showPopup('klc');\n            this.mouseOver('klc');\n            // protected_areas\n            this.showPopup('protected_areas');\n            this.mouseOver('protected_areas');\n            this.setHighlight('protected_areas',\n                (this.level==='national' && this.site!==null),\n                'country',\n                this.site\n            );\n            // concessions\n            this.showPopup('concessions');\n            this.mouseOver('concessions');\n            this.setHighlight('concessions',\n                (this.level==='national' && this.site!==null),\n                'country',\n                this.site\n            );\n        },\n\n\n        // ##############################################\n        // ###############  Manage cards  ###############\n        // ##############################################\n\n        toggleLayersSelector(){\n            this.show_layer_selector = !this.show_layer_selector;\n            if(this.show_layer_selector){\n                this.library.show = false;\n                this.projects.show = false;\n            }\n        },\n\n        toggleLibrary(){\n            this.library.show = !this.library.show;\n            if(this.library.show){\n                this.show_layer_selector = false;\n                this.projects.show = false;\n            }\n        },\n        toggleProjects(){\n            this.projects.show = !this.projects.show;\n            if(this.projects.show){\n                this.show_layer_selector = false;\n                this.library.show = false;\n            }\n        },\n\n        showCardButton(button) {\n            this.library.show = false;\n            this.projects.show = false;\n            if(this.selected_card_button!==null){\n                $('.collapse').collapse('hide'); // necessary 'cause there's a conflict between bootstrap4 and VueJS in accordion body\n            }\n            if(this.selected_card_button!==button){\n                this.selected_card_button = button;\n            } else {\n                this.selected_card_button = null;\n            }\n        },\n\n    }\n\n});","module.exports = {\n\n    // ##########  Base maps - backgrounds  ##########\n\n    mapbox_streets:  window.WebMapping.Leaflet.mapbox_layer('streets', Locale.getLabel('mapping.layers.mapbox_streets')),\n    mapbox_light:  window.WebMapping.Leaflet.mapbox_layer('light', Locale.getLabel('mapping.layers.mapbox_light')),\n    mapbox_satellite:  window.WebMapping.Leaflet.mapbox_layer('satellite', Locale.getLabel('mapping.layers.mapbox_satellite')),\n\n    // ##########  Rasters  ##########\n\n    comifac:  window.WebMapping.Leaflet.mapproxy_wms('comifac', Locale.getLabel('mapping.layers.comifac'),{\n        attribution: '<div style=\"width: 800px;\">' +\n                    '<b>Image source de base :</b> Verhegghen, A., Mayaux, P., de Wasseige, C., and Defourny, P.: ' +\n                    'Mapping Congo Basin vegetation types from 300 m and 1 km multi-sensor time series for carbon stocks' +\n                    ' and forest areas estimation, Biogeosciences, 9, 5061-5079, doi:10.5194/bg-9-5061-2012, 2012. ' +\n                    '<a target=\"_blank\" href=\"http://www.biogeosciences.net/9/5061/2012/bg-9-5061-2012.html\">biogeosciences.net</a>'+\n                    '<br/><b>Données sources ajoutées :</b> SRTM de la Nasa, OSM et OFAC'+\n                    '<br/><b>Traitée :</b> Mai 2015, <a target=\"_blank\" href=\"/docs/atlas/mapsteps.pdf\">Etapes de réalisation</a></div>',\n    }),\n    spotvgt:  window.WebMapping.Leaflet.mapproxy_wms('spotvgt', Locale.getLabel('mapping.layers.spotvgt')),\n    modis:  window.WebMapping.Leaflet.mapproxy_wms('modis', Locale.getLabel('mapping.layers.modis')),\n    srtm:  window.WebMapping.Leaflet.mapproxy_wms('srtm', Locale.getLabel('mapping.layers.srtm')),\n    glc2000:  window.WebMapping.Leaflet.mapproxy_wms('glc2000', Locale.getLabel('mapping.layers.glc2000')),\n    congo_basin_vegetation_map:  window.WebMapping.Leaflet.mapproxy_wms('congo_basin_vegetation_map', Locale.getLabel('mapping.layers.congo_basin_vegetation_map')),\n    total_carbon:  window.WebMapping.Leaflet.mapproxy_wms('total_carbon', Locale.getLabel('mapping.layers.total_carbon')),\n\n    // ##########  External Resources  ##########\n\n    tree_cover: window.Leaflet.tileLayer.wms(\"http://50.18.182.188:6080/arcgis/services/TreeCover2000/ImageServer/WMSServer?\", {\n        layers: '0',\n        format: 'image/png',\n        transparent: true,\n        attribution: 'Hansen/UMD/Google/USGS/NASA, Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>',\n        label: 'Tree Cover (2000-2010)',\n        abstract: encodeURI('Hansen, M. C., P. V. Potapov, R. Moore, M. Hancher, S. A. Turubanova, A. Tyukavina, D. Thau, S. V. Stehman, S. J. Goetz, ' +\n            'T. R. Loveland, A. Kommareddy, A. Egorov, L. Chini, C. O. Justice, and J. R. G. Townshend. 2013. <b>“High-Resolution Global Maps of 21st-Century Forest Cover Change.”</b> ' +\n            'Science 342 (15 November): 850–53. Data available on-line from: <a href=\"https://glad.umd.edu/dataset/global-2010-tree-cover-30-m\" target=\"_blank\">https://glad.umd.edu/dataset/global-2010-tree-cover-30-m</a>. ' +\n            'Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    }),\n    intact_forest: window.Leaflet.tileLayer('https://storage.googleapis.com/earthenginepartners-hansen/tiles/intact_forest_2016/{z}/{x}/{y}.png?', {\n        attribution: '<a href=\"http://www.intactforests.org\" target=\"_blank\">Intact Forest Landscape (IFL)</a>',\n        label: 'Intact Forest Landscapes (IFL 2000-2016)',\n        abstract: encodeURI('Greenpeace, University of Maryland, World Resources Institute and Transparent World. “Intact Forest Landscapes. 2000/2013/2016” ' +\n            'Accessed through <a href=\"https://www.globalforestwatch.org\" target=\"_blank\">Global Forest Watch</a>')\n    }),\n\n    // ##########  Overlays  ##########\n\n    borders: window.WebMapping.Leaflet.mapserver_wms('borders', null, {}),\n    landscapes: window.WebMapping.Leaflet.mapproxy_wms('landscapes', Locale.getLabel('entities.landscape', 2)),\n    klc: window.WebMapping.Leaflet.mapproxy_wms('klc', Locale.getLabel('entities.klc', 2)),\n    concessions: window.WebMapping.Leaflet.mapserver_wms('concessions', Locale.getLabel('form/concession.concession', 2)),\n    protected_areas: window.WebMapping.Leaflet.mapproxy_wms('protected_areas', Locale.getLabel('form/protected_area.protected_area', 2))\n\n\n};"],"sourceRoot":""}